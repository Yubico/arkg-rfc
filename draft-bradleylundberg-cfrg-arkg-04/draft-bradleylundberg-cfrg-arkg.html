<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The Asynchronous Remote Key Generation (ARKG) algorithm</title>
<meta content="Emil Lundberg" name="author">
<meta content="John Bradley" name="author">
<meta content="
       Asynchronous Remote Key Generation (ARKG) is an abstract algorithm
that enables delegation of asymmetric public key generation without giving access to the corresponding private keys.
This capability enables a variety of applications:
a user agent can generate pseudonymous public keys to prevent tracking;
a message sender can generate ephemeral recipient public keys to enhance forward secrecy;
two paired authentication devices can each have their own private keys while each can register public keys on behalf of the other. 
       This document provides three main contributions:
a specification of the generic ARKG algorithm using abstract primitives;
a set of formulae for instantiating the abstract primitives using concrete primitives;
and an initial set of fully specified concrete ARKG instances.
We expect that additional instances will be defined in the future. 
    " name="description">
<meta content="xml2rfc 3.28.0" name="generator">
<meta content="KDF" name="keyword">
<meta content="draft-bradleylundberg-cfrg-arkg-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.0
    Python 3.12.9
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-bradleylundberg-cfrg-arkg.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">ARKG</td>
<td class="right">March 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Lundberg &amp; Bradley</td>
<td class="center">Expires 4 September 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Crypto Forum</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-bradleylundberg-cfrg-arkg-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-03-03" class="published">3 March 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-09-04">4 September 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">E. Lundberg, <span class="editor">Ed.</span>
</div>
<div class="org">Yubico</div>
</div>
<div class="author">
      <div class="author-name">J. Bradley</div>
<div class="org">Yubico</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The Asynchronous Remote Key Generation (ARKG) algorithm</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Asynchronous Remote Key Generation (ARKG) is an abstract algorithm
that enables delegation of asymmetric public key generation without giving access to the corresponding private keys.
This capability enables a variety of applications:
a user agent can generate pseudonymous public keys to prevent tracking;
a message sender can generate ephemeral recipient public keys to enhance forward secrecy;
two paired authentication devices can each have their own private keys while each can register public keys on behalf of the other.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document provides three main contributions:
a specification of the generic ARKG algorithm using abstract primitives;
a set of formulae for instantiating the abstract primitives using concrete primitives;
and an initial set of fully specified concrete ARKG instances.
We expect that additional instances will be defined in the future.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-bradleylundberg-cfrg-arkg/">https://datatracker.ietf.org/doc/draft-bradleylundberg-cfrg-arkg/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/Yubico/arkg-rfc">https://github.com/Yubico/arkg-rfc</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 4 September 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-notation" class="internal xref">Notation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-the-asynchronous-remote-key" class="internal xref">The Asynchronous Remote Key Generation (ARKG) algorithm</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-instance-parameters" class="internal xref">Instance parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-the-function-arkg-generate-" class="internal xref">The function ARKG-Generate-Seed</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-deterministic-key-generatio" class="internal xref">Deterministic key generation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-the-function-arkg-derive-pu" class="internal xref">The function ARKG-Derive-Public-Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-the-function-arkg-derive-pr" class="internal xref">The function ARKG-Derive-Private-Key</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-generic-arkg-instantiations" class="internal xref">Generic ARKG instantiations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-using-elliptic-curve-additi" class="internal xref">Using elliptic curve addition for key blinding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-using-hmac-to-adapt-a-kem-w" class="internal xref">Using HMAC to adapt a KEM without ciphertext integrity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-using-ecdh-as-the-kem" class="internal xref">Using ECDH as the KEM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-using-x25519-or-x448-as-the" class="internal xref">Using X25519 or X448 as the KEM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-using-the-same-key-for-both" class="internal xref">Using the same key for both key blinding and KEM</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-concrete-arkg-instantiation" class="internal xref">Concrete ARKG instantiations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-arkg-p256add-ecdh" class="internal xref">ARKG-P256ADD-ECDH</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-arkg-p384add-ecdh" class="internal xref">ARKG-P384ADD-ECDH</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-arkg-p521add-ecdh" class="internal xref">ARKG-P521ADD-ECDH</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-arkg-p256kadd-ecdh" class="internal xref">ARKG-P256kADD-ECDH</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-arkg-curve25519add-x25519" class="internal xref">ARKG-curve25519ADD-X25519</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-arkg-curve448add-x448" class="internal xref">ARKG-curve448ADD-X448</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-arkg-edwards25519add-x25519" class="internal xref">ARKG-edwards25519ADD-X25519</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.  <a href="#name-arkg-edwards448add-x448" class="internal xref">ARKG-edwards448ADD-X448</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-cose-bindings" class="internal xref">COSE bindings</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-cose-key-type-arkg-public-s" class="internal xref">COSE key type: ARKG public seed</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-cose-key-reference-type-ark" class="internal xref">COSE key reference type: ARKG derived private key</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-cose-key-types-registration" class="internal xref">COSE Key Types Registrations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-cose-key-type-parameters-re" class="internal xref">COSE Key Type Parameters Registrations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-cose-algorithms-registratio" class="internal xref">COSE Algorithms Registrations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-design-rationale" class="internal xref">Design rationale</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-using-a-mac" class="internal xref">Using a MAC</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Asynchronous Remote Key Generation (ARKG) introduces a mechanism
to generate public keys without access to the corresponding private keys.
Such a mechanism is useful for many scenarios when a new public key is needed
but the private key holder is not available to perform the key generation.
This may occur when private keys are stored in a hardware security device,
which may be unavailable or locked at the time a new public key is needed.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Some motivating use cases of ARKG include:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
          <p id="section-1-3.1.1"><strong>Single-use asymmetric keys</strong>:
Envisioned for the European Union's digital identity framework,
which is set to use single-use asymmetric keys to prevent colluding verifiers from using public keys as correlation handles.
Each digital identity credential would thus be issued with a single-use proof-of-possession key,
used only once to present the credential to a verifier.
ARKG empowers both online and offline usage scenarios:
for offline scenarios, ARKG enables pre-generation of public keys for single-use credentials
without needing to access the hardware security device that holds the private keys.
For online scenarios, ARKG gives the credential issuer assurance
that all derived private keys are bound to the same secure hardware element.
In both cases, application performance may be improved
since public keys can be generated in a general-purpose execution environment instead of a secure enclave.<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.2">
          <p id="section-1-3.2.1"><strong>Enhanced forward secrecy</strong>:
The use of ARKG can facilitate forward secrecy in certain contexts.
For instance, <a href="https://www.rfc-editor.org/rfc/rfc9052.html#name-direct-key-agreement">section 8.5.4 of RFC 9052</a> notes that
"Since COSE is designed for a store-and-forward environment rather than an online environment,
[...] forward secrecy (see <span>[<a href="#RFC4949" class="cite xref">RFC4949</a>]</span>) is not achievable. A static key will always be used for the receiver of the COSE object."
As opposed to workarounds like exchanging a large number of keys in advance,
ARKG enables the the sender to generate ephemeral recipient public keys on demand.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.3">
          <p id="section-1-3.3.1"><strong>Backup key generation</strong>:
For example, the W3C Web Authentication API [WebAuthn] (WebAuthn) generates a new key pair for each account on each web site.
ARKG could allow for simultaneously generating a backup public key when registering a new public key.
A primary authenticator could generate both a key pair for itself and a public key for a paired backup authenticator.
The backup authenticator only needs to be paired with the primary authenticator once,
and can then be safely stored until it is needed.<a href="#section-1-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-4">ARKG consists of three procedures:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">
          <p id="section-1-5.1.1"><strong>Initialization</strong>:
The <em>delegating party</em> generates a <em>seed pair</em> and discloses the <em>public seed</em> to a <em>subordinate party</em>,
while securely retaining the <em>private seed</em>.<a href="#section-1-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.2">
          <p id="section-1-5.2.1"><strong>Public key generation</strong>:
The subordinate party uses the public seed to autonomously generate a new public key
along with a unique <em>key handle</em> for the public key.
This can be repeated any number of times.<a href="#section-1-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.3">
          <p id="section-1-5.3.1"><strong>Private key derivation</strong>:
The delegating party uses a key handle and the private seed
to derive the private key corresponding to the public key generated along with the key handle.
This can be repeated with any number of key handles.<a href="#section-1-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-6">Notably, ARKG can be built entirely using established cryptographic primitives.
The required primitives are a public key blinding scheme and a key encapsulation mechanism (KEM),
which may in turn use a key derivation function (KDF) and a message authentication code (MAC) scheme.
Both conventional primitives and quantum-resistant alternatives exist that meet these requirements. <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span><a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="requirements-language">
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notation">
<section id="section-1.2">
        <h3 id="name-notation">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-notation" class="section-name selfRef">Notation</a>
        </h3>
<p id="section-1.2-1">The following notation is used throughout this document:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">
            <p id="section-1.2-2.1.1">The symbol <code>||</code> represents octet string concatenation.<a href="#section-1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.2">
            <p id="section-1.2-2.2.1">Literal text strings and octet strings are denoted
using the CDDL syntax defined in <span><a href="https://rfc-editor.org/rfc/rfc8610#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>.<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.3">
            <p id="section-1.2-2.3.1">Elliptic curve operations are written in additive notation:
<code>+</code> denotes point addition, i.e., the curve group operation;
<code>*</code> denotes point multiplication, i.e., repeated point addition;
and <code>+</code> also denotes scalar addition modulo the curve order.
<code>*</code> has higher precedence than <code>+</code>, i.e., <code>a + b * C</code> is equivalent to <code>a + (b * C)</code>.<a href="#section-1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="the-asynchronous-remote-key-generation-arkg-algorithm">
<section id="section-2">
      <h2 id="name-the-asynchronous-remote-key">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-the-asynchronous-remote-key" class="section-name selfRef">The Asynchronous Remote Key Generation (ARKG) algorithm</a>
      </h2>
<p id="section-2-1">The ARKG algorithm consists of three functions, each performed by one of two participants:
the <em>delegating party</em> or the <em>subordinate party</em>.
The delegating party generates an ARKG <em>seed pair</em> and emits the <em>public seed</em> to the subordinate party
while keeping the <em>private seed</em> secret.
The subordinate party can then use the public seed to generate derived public keys and <em>key handles</em>,
and the delegating party can use the private seed and a key handle to derive the corresponding private key.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The following subsections define the abstract instance parameters used to construct the three ARKG functions,
followed by the definitions of the three ARKG functions.<a href="#section-2-2" class="pilcrow">¶</a></p>
<div id="arkg-params">
<section id="section-2.1">
        <h3 id="name-instance-parameters">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-instance-parameters" class="section-name selfRef">Instance parameters</a>
        </h3>
<p id="section-2.1-1">ARKG is composed of a suite of other algorithms.
The parameters of an ARKG instance are:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">
            <p id="section-2.1-2.1.1"><code>BL</code>: An asymmetric key blinding scheme <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span>, consisting of:<a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1.2.1">
                <p id="section-2.1-2.1.2.1.1">Function <code>BL-Generate-Keypair() -&gt; (pk, sk)</code>: Generate a blinding key pair.<a href="#section-2.1-2.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.2.1.2">
No input.<a href="#section-2.1-2.1.2.1.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.2.1.3">
Output consists of a blinding public key <code>pk</code> and a blinding private key <code>sk</code>.<a href="#section-2.1-2.1.2.1.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.1.2.2">
                <p id="section-2.1-2.1.2.2.1">Function <code>BL-Blind-Public-Key(pk, tau, info) -&gt; pk_tau</code>: Deterministically compute a blinded public key.<a href="#section-2.1-2.1.2.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.2.2.2">
Input consists of a blinding public key <code>pk</code>,
a blinding factor <code>tau</code>
and a domain separation parameter <code>info</code>.<a href="#section-2.1-2.1.2.2.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.2.2.3">
Output consists of the blinded public key <code>pk_tau</code>.<a href="#section-2.1-2.1.2.2.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.1.2.3">
                <p id="section-2.1-2.1.2.3.1">Function <code>BL-Blind-Private-Key(sk, tau, info) -&gt; sk_tau</code>: Deterministically compute a blinded private key.<a href="#section-2.1-2.1.2.3.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.2.3.2">
Input consists of a blinding private key <code>sk</code>,
a blinding factor <code>tau</code>
and a domain separation parameter <code>info</code>.<a href="#section-2.1-2.1.2.3.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.2.3.3">
Output consists of the blinded private key <code>sk_tau</code>.<a href="#section-2.1-2.1.2.3.3" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.1-2.1.3">
<code>tau</code> and <code>info</code> are an opaque octet strings of arbitrary length.
The representations of <code>pk</code> and <code>pk_tau</code> are defined by the protocol that invokes ARKG.
The representations of <code>sk</code> and <code>sk_tau</code> are an undefined implementation detail.<a href="#section-2.1-2.1.3" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.4">
See <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span> for definitions of security properties required of the key blinding scheme <code>BL</code>.<a href="#section-2.1-2.1.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1"><code>KEM</code>: A key encapsulation mechanism <span>[<a href="#Shoup" class="cite xref">Shoup</a>]</span>, consisting of the functions:<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.2.2.1">
                <p id="section-2.1-2.2.2.1.1"><code>KEM-Generate-Keypair() -&gt; (pk, sk)</code>: Generate a key encapsulation key pair.<a href="#section-2.1-2.2.2.1.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2.1.2">
No input.<a href="#section-2.1-2.2.2.1.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2.1.3">
Output consists of public key <code>pk</code> and private key <code>sk</code>.<a href="#section-2.1-2.2.2.1.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.2.2.2">
                <p id="section-2.1-2.2.2.2.1"><code>KEM-Encaps(pk, info) -&gt; (k, c)</code>: Generate a key encapsulation.<a href="#section-2.1-2.2.2.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2.2.2">
Input consists of an encapsulation public key <code>pk</code>
and a domain separation parameter <code>info</code>.<a href="#section-2.1-2.2.2.2.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2.2.3">
Output consists of a shared secret <code>k</code> and an encapsulation ciphertext <code>c</code>.<a href="#section-2.1-2.2.2.2.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.2.2.3">
                <p id="section-2.1-2.2.2.3.1"><code>KEM-Decaps(sk, c, info) -&gt; k</code>: Decapsulate a shared secret.<a href="#section-2.1-2.2.2.3.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2.3.2">
Input consists of encapsulation private key <code>sk</code>, encapsulation ciphertext <code>c</code>
and a domain separation parameter <code>info</code>.<a href="#section-2.1-2.2.2.3.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2.3.3">
Output consists of the shared secret <code>k</code> on success, or an error otherwise.<a href="#section-2.1-2.2.2.3.3" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.1-2.2.3">
<code>k</code>, <code>c</code> and <code>info</code> are opaque octet strings of arbitrary length.
The representation of <code>pk</code> is defined by the protocol that invokes ARKG.
The representation of <code>sk</code> is an undefined implementation detail.<a href="#section-2.1-2.2.3" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.4">
The KEM <span class="bcp14">MUST</span> guarantee integrity of the ciphertext,
meaning that knowledge of the public key <code>pk</code> and the domain separation parameter <code>info</code>
is required in order to create any ciphertext <code>c</code> that can be successfully decapsulated by the corresponding private key <code>sk</code>.
<a href="#hmac-kem" class="auto internal xref">Section 3.2</a> describes a general formula for how any KEM can be adapted to include this guarantee.
<a href="#design-rationale-mac" class="auto internal xref">Section 9.1</a> discusses the reasons for this requirement.<a href="#section-2.1-2.2.4" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.5">
See <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span> for definitions of additional security properties required of the key encapsulation mechanism <code>KEM</code>.<a href="#section-2.1-2.2.5" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-3">A concrete ARKG instantiation <span class="bcp14">MUST</span> specify the instantiation
of each of the above functions and values.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">The output keys of the <code>BL</code> scheme are also the output keys of the ARKG instance as a whole.
For example, if <code>BL-Blind-Public-Key</code> and <code>BL-Blind-Private-Key</code> output ECDSA keys,
then the ARKG instance will also output ECDSA keys.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">We denote a concrete ARKG instance by the pattern <code>ARKG-BL-KEM</code>,
substituting the chosen instantiation for the <code>BL</code> and <code>KEM</code>.
Note that this pattern cannot in general be unambiguously parsed;
implementations <span class="bcp14">MUST NOT</span> attempt to construct an ARKG instance by parsing such a pattern string.
Concrete ARKG instances <span class="bcp14">MUST</span> always be identified by lookup in a registry of fully specified ARKG instances.
This is to prevent usage of algorithm combinations that may be incompatible or insecure.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-function-arkg-generate-seed">
<section id="section-2.2">
        <h3 id="name-the-function-arkg-generate-">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-the-function-arkg-generate-" class="section-name selfRef">The function ARKG-Generate-Seed</a>
        </h3>
<p id="section-2.2-1">This function is performed by the delegating party.
The delegating party generates the ARKG seed pair <code>(pk, sk)</code>
and keeps the private seed <code>sk</code> secret, while the public seed <code>pk</code> is provided to the subordinate party.
The subordinate party will then be able to generate public keys on behalf of the delegating party.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-2.2-2">
<pre>
ARKG-Generate-Seed() -&gt; (pk, sk)
    ARKG instance parameters:
        BL        A key blinding scheme.
        KEM       A key encapsulation mechanism.

    Inputs: None

    Output:
        (pk, sk)  An ARKG seed pair with public seed pk
                    and private seed sk.

    The output (pk, sk) is calculated as follows:

    (pk_kem, sk_kem) = KEM-Generate-Keypair()
    (pk_bl, sk_bl) = BL-Generate-Keypair()
    pk = (pk_kem, pk_bl)
    sk = (sk_kem, sk_bl)
</pre><a href="#section-2.2-2" class="pilcrow">¶</a>
</div>
<div id="deterministic-key-generation">
<section id="section-2.2.1">
          <h4 id="name-deterministic-key-generatio">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-deterministic-key-generatio" class="section-name selfRef">Deterministic key generation</a>
          </h4>
<p id="section-2.2.1-1">Although the above definition expresses the key generation as opaque,
likely sampling uniformly random key distributions,
implementations <span class="bcp14">MAY</span> choose to implement the functions <code>BL-Generate-Keypair()</code>,
<code>KEM-Generate-Keypair()</code> and <code>ARKG-Generate-Seed()</code>
as deterministic functions of some out-of-band input.
This can be thought of as defining a single-use ARKG instance where these function outputs are static.
This use case is beyond the scope of this document
since the implementation of <code>ARKG-Generate-Seed</code> is internal to the delegating party,
even if applications choose to distribute the delegating party across multiple processing entities.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2">For example, one entity may randomly sample <code>pk_bl</code>, derive <code>pk_kem</code> deterministically from <code>pk_bl</code>
and submit only <code>pk_bl</code> to a separate service that uses the same procedure to also derive the same <code>pk_kem</code>.
This document considers both of these entities as parts of the same logical delegating party.<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="the-function-arkg-derive-public-key">
<section id="section-2.3">
        <h3 id="name-the-function-arkg-derive-pu">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-the-function-arkg-derive-pu" class="section-name selfRef">The function ARKG-Derive-Public-Key</a>
        </h3>
<p id="section-2.3-1">This function is performed by the subordinate party, which holds the ARKG public seed <code>pk = (pk_kem, pk_bl)</code>.
The resulting public key <code>pk'</code> can be provided to external parties to use in asymmetric cryptography protocols,
and the resulting key handle <code>kh</code> can be used by the delegating party to derive the private key corresponding to <code>pk'</code>.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">This function may be invoked any number of times with the same public seed,
in order to generate any number of public keys.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-2.3-3">
<pre>
ARKG-Derive-Public-Key((pk_kem, pk_bl), info) -&gt; (pk', kh)
    ARKG instance parameters:
        BL        A key blinding scheme.
        KEM       A key encapsulation mechanism.

    Inputs:
        pk_kem    A key encapsulation public key.
        pk_bl     A key blinding public key.
        info      An octet string containing optional context
                    and application specific information
                    (can be a zero-length string).

    Output:
        pk'       A blinded public key.
        kh        A key handle for deriving the blinded
                    private key sk' corresponding to pk'.

    The output (pk', kh) is calculated as follows:

    info_kem = 'ARKG-Derive-Key-KEM.' || info
    info_bl  = 'ARKG-Derive-Key-BL.'  || info

    (tau, c) = KEM-Encaps(pk_kem, info_kem)
    pk' = BL-Blind-Public-Key(pk_bl, tau, info_bl)

    kh = c
</pre><a href="#section-2.3-3" class="pilcrow">¶</a>
</div>
<p id="section-2.3-4">If this procedure aborts due to an error,
the procedure can safely be retried with the same arguments.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-function-arkg-derive-private-key">
<section id="section-2.4">
        <h3 id="name-the-function-arkg-derive-pr">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-the-function-arkg-derive-pr" class="section-name selfRef">The function ARKG-Derive-Private-Key</a>
        </h3>
<p id="section-2.4-1">This function is performed by the delegating party, which holds the ARKG private seed <code>(sk_kem, sk_bl)</code>.
The resulting private key <code>sk'</code> can be used in asymmetric cryptography protocols
to prove possession of <code>sk'</code> to an external party that has the corresponding public key.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">This function may be invoked any number of times with the same private seed,
in order to derive the same or different private keys any number of times.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-2.4-3">
<pre>
ARKG-Derive-Private-Key((sk_kem, sk_bl), kh, info) -&gt; sk'
    ARKG instance parameters:
        BL        A key blinding scheme.
        KEM       A key encapsulation mechanism.

    Inputs:
        sk_kem    A key encapsulation private key.
        sk_bl     A key blinding private key.
        kh        A key handle output from ARKG-Derive-Public-Key.
        info      An octet string containing optional context
                    and application specific information
                    (can be a zero-length string).

    Output:
        sk'       A blinded private key.

    The output sk' is calculated as follows:

    info_kem = 'ARKG-Derive-Key-KEM.' || info
    info_bl  = 'ARKG-Derive-Key-BL.'  || info

    tau = KEM-Decaps(sk_kem, kh, info_kem)
    If decapsulation failed:
        Abort with an error.

    sk' = BL-Blind-Private-Key(sk_bl, tau, info_bl)
</pre><a href="#section-2.4-3" class="pilcrow">¶</a>
</div>
<p id="section-2.4-4">Errors in this procedure are typically unrecoverable.
For example, <code>KEM-Decaps</code> may fail to decapsulate the KEM ciphertext <code>kh</code> if it fails an integrity check.
ARKG instantiations <span class="bcp14">SHOULD</span> be chosen in a way that such errors are impossible
if <code>kh</code> was generated by an honest and correct implementation of <code>ARKG-Derive-Public-Key</code>.
Incorrect or malicious implementations of <code>ARKG-Derive-Public-Key</code> do not degrade the security
of a correct and honest implementation of <code>ARKG-Derive-Private-Key</code>.
See also <a href="#design-rationale-mac" class="auto internal xref">Section 9.1</a>.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="generic-arkg-instantiations">
<section id="section-3">
      <h2 id="name-generic-arkg-instantiations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-generic-arkg-instantiations" class="section-name selfRef">Generic ARKG instantiations</a>
      </h2>
<p id="section-3-1">This section defines generic formulae for instantiating the individual ARKG parameters,
which can be used to define concrete ARKG instantiations.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="blinding-ec">
<section id="section-3.1">
        <h3 id="name-using-elliptic-curve-additi">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-using-elliptic-curve-additi" class="section-name selfRef">Using elliptic curve addition for key blinding</a>
        </h3>
<p id="section-3.1-1">Instantiations of ARKG whose output keys are elliptic curve keys
can use elliptic curve addition as the key blinding scheme <code>BL</code> <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span> <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span>.
This section defines a general formula for such instantiations of <code>BL</code>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">This formula has the following parameters:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1">
            <p id="section-3.1-3.1.1"><code>crv</code>: An elliptic curve.<a href="#section-3.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.2">
            <p id="section-3.1-3.2.1"><code>hash-to-crv-suite</code>: A hash-to-curve suite <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>
suitable for hashing to the scalar field of <code>crv</code>.<a href="#section-3.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.3">
            <p id="section-3.1-3.3.1"><code>DST_ext</code>: A domain separation tag.<a href="#section-3.1-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-4">Then the <code>BL</code> parameter of ARKG may be instantiated as follows:<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-5.1">
            <p id="section-3.1-5.1.1"><code>G</code> is the generator of the prime order subgroup of <code>crv</code>.<a href="#section-3.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-5.2">
            <p id="section-3.1-5.2.1"><code>N</code> is the order of <code>G</code>.<a href="#section-3.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-5.3">
            <p id="section-3.1-5.3.1">The function <code>hash_to_field</code> is defined in <span><a href="https://rfc-editor.org/rfc/rfc9380#section-5" class="relref">Section 5</a> of [<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#section-3.1-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="lang-pseudocode sourcecode" id="section-3.1-6">
<pre>
BL-Generate-Keypair() -&gt; (pk, sk)

    Generate (pk, sk) using some procedure defined for the curve crv.


BL-Blind-Public-Key(pk, tau, info) -&gt; pk_tau

    tau' = hash_to_field(tau, 1) with the parameters:
        DST: 'ARKG-BL-EC.' || DST_ext || info
        F: GF(N), the scalar field
           of the prime order subgroup of crv
        p: N
        m: 1
        L: The L defined in hash-to-crv-suite
        expand_message: The expand_message function
                        defined in hash-to-crv-suite

    pk_tau = pk + tau' * G


BL-Blind-Private-Key(sk, tau, info) -&gt; sk_tau

    tau' = hash_to_field(tau, 1) with the parameters:
        DST: 'ARKG-BL-EC.' || DST_ext || info
        F: GF(N), the scalar field
           of the prime order subgroup of crv.
        p: N
        m: 1
        L: The L defined in hash-to-crv-suite
        expand_message: The expand_message function
                        defined in hash-to-crv-suite

    sk_tau_tmp = sk + tau'
    If sk_tau_tmp = 0, abort with an error.
    sk_tau = sk_tau_tmp
</pre><a href="#section-3.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="hmac-kem">
<section id="section-3.2">
        <h3 id="name-using-hmac-to-adapt-a-kem-w">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-using-hmac-to-adapt-a-kem-w" class="section-name selfRef">Using HMAC to adapt a KEM without ciphertext integrity</a>
        </h3>
<p id="section-3.2-1">Not all key encapsulation mechanisms guarantee ciphertext integrity,
meaning that a valid KEM ciphertext can be created only with knowledge of the KEM public key.
This section defines a general formula for adapting any KEM to guarantee ciphertext integrity
by prepending a MAC to the KEM ciphertext.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">For example, ECDH does not guarantee ciphertext integrity - any elliptic curve point is a valid ECDH ciphertext
and can be successfully decapsulated using any elliptic curve private scalar.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">This formula has the following parameters:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">
            <p id="section-3.2-4.1.1"><code>Hash</code>: A cryptographic hash function.<a href="#section-3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-4.2">
            <p id="section-3.2-4.2.1"><code>DST_ext</code>: A domain separation parameter.<a href="#section-3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-4.3">
            <p id="section-3.2-4.3.1"><code>Sub-Kem</code>: A key encapsulation mechanism as described for the <code>KEM</code> parameter in <a href="#arkg-params" class="auto internal xref">Section 2.1</a>,
except <code>Sub-Kem</code> <span class="bcp14">MAY</span> ignore the <code>info</code> parameter and <span class="bcp14">MAY</span> not guarantee ciphertext integrity.
<code>Sub-Kem</code> defines the functions <code>Sub-Kem-Generate-Keypair</code>, <code>Sub-Kem-Encaps</code> and <code>Sub-Kem-Decaps</code>.<a href="#section-3.2-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-5">The <code>KEM</code> parameter of ARKG may be instantiated using <code>Sub-Kem</code>,
HMAC <span>[<a href="#RFC2104" class="cite xref">RFC2104</a>]</span> and HKDF <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span> as follows:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">
            <p id="section-3.2-6.1.1"><code>L</code> is the output length of <code>Hash</code> in octets.<a href="#section-3.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-6.2">
            <p id="section-3.2-6.2.1"><code>LEFT(X, n)</code> is the first <code>n</code> bytes of the byte array <code>X</code>.<a href="#section-3.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-6.3">
            <p id="section-3.2-6.3.1"><code>DROP_LEFT(X, n)</code> is the byte array <code>X</code> without the first <code>n</code> bytes.<a href="#section-3.2-6.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-7">We truncate the HMAC output to 128 bits (16 octets)
because as described in <a href="#design-rationale-mac" class="auto internal xref">Section 9.1</a>,
ARKG needs ciphertext integrity only to ensure correctness, not for security.
Extendable-output functions used as the <code>Hash</code> parameter <span class="bcp14">SHOULD</span> still be instantiated
with an output length appropriate for the desired security level,
in order to not leak information about the <code>Sub-KEM</code> shared secret key.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<div class="breakable lang-pseudocode sourcecode" id="section-3.2-8">
<pre>
KEM-Generate-Keypair() -&gt; (pk, sk)

    (pk, sk) = Sub-Kem-Generate-Keypair()


KEM-Encaps(pk, info) -&gt; (k, c)

    info_sub = 'ARKG-KEM-HMAC.' || DST_ext || info
    (k', c') = Sub-Kem-Encaps(pk, info_sub)

    prk = HKDF-Extract with the arguments:
        Hash: Hash
        salt: not set
        IKM: k'

    mk = HKDF-Expand with the arguments:
        Hash: Hash
        PRK: prk
        info: 'ARKG-KEM-HMAC-mac.' || DST_ext || info
        L: L
    t = HMAC-Hash-128(K=mk, text=c')

    k = HKDF-Expand with the arguments:
        Hash: Hash
        PRK: prk
        info: 'ARKG-KEM-HMAC-shared.' || DST_ext || info
        L: The length of k' in octets.
    c = t || c'


KEM-Decaps(sk, c, info) -&gt; k

    t = LEFT(c, 16)
    c' = DROP_LEFT(c, 16)
    info_sub = 'ARKG-KEM-HMAC.' || DST_ext || info
    k' = Sub-Kem-Decaps(sk, c', info_sub)

    prk = HKDF-Extract with the arguments:
        Hash: Hash
        salt: not set
        IKM: k'

    mk = HKDF-Expand with the arguments:
        Hash: Hash
        PRK: prk
        info: 'ARKG-KEM-HMAC-mac.' || DST_ext || info
        L: L

    t' = HMAC-Hash-128(K=mk, text=c')
    If t = t':
        k = HKDF-Expand with the arguments:
            Hash: Hash
            PRK: prk
            info: 'ARKG-KEM-HMAC-shared.' || DST_ext || info
            L: The length of k' in octets.
    Else:
        Abort with an error.
</pre><a href="#section-3.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="kem-ecdh">
<section id="section-3.3">
        <h3 id="name-using-ecdh-as-the-kem">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-using-ecdh-as-the-kem" class="section-name selfRef">Using ECDH as the KEM</a>
        </h3>
<p id="section-3.3-1">Instantiations of ARKG can use ECDH <span>[<a href="#RFC6090" class="cite xref">RFC6090</a>]</span> as the key encapsulation mechanism <code>KEM</code> <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span> <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span>.
This section defines a general formula for such instantiations of <code>KEM</code>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">This formula has the following parameters:<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-3.1">
            <p id="section-3.3-3.1.1"><code>crv</code>: an elliptic curve valid for use with ECDH <span>[<a href="#RFC6090" class="cite xref">RFC6090</a>]</span>.<a href="#section-3.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.2">
            <p id="section-3.3-3.2.1"><code>Hash</code>: A cryptographic hash function.<a href="#section-3.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.3">
            <p id="section-3.3-3.3.1"><code>DST_ext</code>: A domain separation parameter.<a href="#section-3.3-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-4">The <code>KEM</code> parameter of ARKG may be instantiated as described in section <a href="#hmac-kem" class="auto internal xref">Section 3.2</a> with the parameters:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-5.1">
            <p id="section-3.3-5.1.1"><code>Hash</code>: <code>Hash</code>.<a href="#section-3.3-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-5.2">
            <p id="section-3.3-5.2.1"><code>DST_ext</code>: <code>'ARKG-ECDH.' || DST_ext</code>.<a href="#section-3.3-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-5.3">
            <p id="section-3.3-5.3.1"><code>Sub-Kem</code>: The functions <code>Sub-Kem-Generate-Keypair</code>, <code>Sub-Kem-Encaps</code> and <code>Sub-Kem-Decaps</code> defined as follows:<a href="#section-3.3-5.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-5.3.2.1">
                <p id="section-3.3-5.3.2.1.1"><code>Elliptic-Curve-Point-to-Octet-String</code> and <code>Octet-String-to-Elliptic-Curve-Point</code>
are the conversion routines defined in sections 2.3.3 and 2.3.4 of <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>,
without point compression.<a href="#section-3.3-5.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3-5.3.2.2">
                <p id="section-3.3-5.3.2.2.1"><code>ECDH(pk, sk)</code> represents the compact output of ECDH <span>[<a href="#RFC6090" class="cite xref">RFC6090</a>]</span>
using public key (curve point) <code>pk</code> and private key (exponent) <code>sk</code>.<a href="#section-3.3-5.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3-5.3.2.3">
                <p id="section-3.3-5.3.2.3.1"><code>G</code> is the generator of the prime order subgroup of <code>crv</code>.<a href="#section-3.3-5.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3-5.3.2.4">
                <p id="section-3.3-5.3.2.4.1"><code>N</code> is the order of <code>G</code>.<a href="#section-3.3-5.3.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<div class="lang-pseudocode sourcecode" id="section-3.3-5.3.3">
<pre>
Sub-Kem-Generate-Keypair() -&gt; (pk, sk)

    Generate (pk, sk) using some procedure defined for crv.


Sub-Kem-Encaps(pk, info) -&gt; (k, c)

    (pk', sk') = Sub-Kem-Generate-Keypair()

    k = ECDH(pk, sk')
    c = Elliptic-Curve-Point-to-Octet-String(pk')


Sub-Kem-Decaps(sk, c, info) -&gt; k

    pk' = Octet-String-to-Elliptic-Curve-Point(c)
    k = ECDH(pk', sk)
</pre><a href="#section-3.3-5.3.3" class="pilcrow">¶</a>
</div>
</li>
        </ul>
</section>
</div>
<div id="kem-x25519-x448">
<section id="section-3.4">
        <h3 id="name-using-x25519-or-x448-as-the">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-using-x25519-or-x448-as-the" class="section-name selfRef">Using X25519 or X448 as the KEM</a>
        </h3>
<p id="section-3.4-1">Instantiations of ARKG can use X25519 or X448 <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span> as the key encapsulation mechanism <code>KEM</code>.
This section defines a general formula for such instantiations of <code>KEM</code>.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">This formula has the following parameters:<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-3.1">
            <p id="section-3.4-3.1.1"><code>DH-Function</code>: the function X25519 or the function X448 <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-3.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-3.2">
            <p id="section-3.4-3.2.1"><code>DST_ext</code>: A domain separation parameter.<a href="#section-3.4-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-4">The <code>KEM</code> parameter of ARKG may be instantiated as described in section <a href="#hmac-kem" class="auto internal xref">Section 3.2</a> with the parameters:<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-5.1">
            <p id="section-3.4-5.1.1"><code>Hash</code>: SHA-512 [FIPS 180-4] if <code>DH-Function</code> is X25519,
or SHAKE256 [FIPS 202] with output length 64 octets if <code>DH-Function</code> is X448.<a href="#section-3.4-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-5.2">
            <p id="section-3.4-5.2.1"><code>DST_ext</code>: <code>'ARKG-ECDHX.' || DST_ext</code>.<a href="#section-3.4-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-5.3">
            <p id="section-3.4-5.3.1"><code>Sub-Kem</code>: The functions <code>Sub-Kem-Generate-Keypair</code>, <code>Sub-Kem-Encaps</code> and <code>Sub-Kem-Decaps</code> defined as follows:<a href="#section-3.4-5.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-5.3.2.1">
                <p id="section-3.4-5.3.2.1.1"><code>Random-Bytes(N)</code> represents a cryptographically secure,
uniformly distributed random octet string of length <code>N</code>.<a href="#section-3.4-5.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4-5.3.2.2">
                <p id="section-3.4-5.3.2.2.1"><code>L</code> is 32 if <code>DH-Function</code> is X25519, or 56 if <code>DH-Function</code> is X448.<a href="#section-3.4-5.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4-5.3.2.3">
                <p id="section-3.4-5.3.2.3.1"><code>G</code> is the octet string <code>h'0900000000000000 0000000000000000 0000000000000000 0000000000000000'</code>
if <code>DH-Function</code> is X25519,
or the octet string <code>h'0500000000000000 0000000000000000 0000000000000000 0000000000000000 0000000000000000 0000000000000000 0000000000000000'</code>
if <code>DH-Function</code> is X448.<a href="#section-3.4-5.3.2.3.1" class="pilcrow">¶</a></p>
<p id="section-3.4-5.3.2.3.2">
These are the little-endian encodings of the integers 9 and 5,
which is the u-coordinate of the generator point of the respective curve group.<a href="#section-3.4-5.3.2.3.2" class="pilcrow">¶</a></p>
</li>
            </ul>
<div class="lang-pseudocode sourcecode" id="section-3.4-5.3.3">
<pre>
Sub-Kem-Generate-Keypair() -&gt; (pk, sk)

    sk = Random-Bytes(L)
    pk = DH-Function(sk, G)


Sub-Kem-Encaps(pk, info) -&gt; (k, c)

    (pk', sk') = Sub-Kem-Generate-Keypair()

    k = DH-Function(sk', pk)
    c = pk'


Sub-Kem-Decaps(sk, c, info) -&gt; k

    k = DH-Function(sk, c)
</pre><a href="#section-3.4-5.3.3" class="pilcrow">¶</a>
</div>
</li>
        </ul>
</section>
</div>
<div id="blinding-kem-same-key">
<section id="section-3.5">
        <h3 id="name-using-the-same-key-for-both">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-using-the-same-key-for-both" class="section-name selfRef">Using the same key for both key blinding and KEM</a>
        </h3>
<p id="section-3.5-1">When an ARKG instance uses the same type of key for both the key blinding and the KEM -
for example, if elliptic curve arithmetic is used for key blinding as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a>
and ECDH is used as the KEM as described in <a href="#kem-ecdh" class="auto internal xref">Section 3.3</a> <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span> -
then the two keys <span class="bcp14">MAY</span> be the same key.
Representations of such an ARKG seed <span class="bcp14">MAY</span> allow for omitting the second copy of the constituent key,
but such representations <span class="bcp14">MUST</span> clearly identify that the single constituent key is to be used
both as the key blinding key and the KEM key.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="concrete-arkg-instantiations">
<section id="section-4">
      <h2 id="name-concrete-arkg-instantiation">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-concrete-arkg-instantiation" class="section-name selfRef">Concrete ARKG instantiations</a>
      </h2>
<p id="section-4-1">This section defines an initial set of concrete ARKG instantiations.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">TODO: IANA registry? COSE/JOSE?<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="ARKG-P256ADD-ECDH">
<section id="section-4.1">
        <h3 id="name-arkg-p256add-ecdh">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-arkg-p256add-ecdh" class="section-name selfRef">ARKG-P256ADD-ECDH</a>
        </h3>
<p id="section-4.1-1">The identifier <code>ARKG-P256ADD-ECDH</code> represents the following ARKG instance:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1"><code>BL</code>: Elliptic curve addition as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameters:<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1.2.1">
                <p id="section-4.1-2.1.2.1.1"><code>crv</code>: The NIST curve <code>secp256r1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1-2.1.2.2">
                <p id="section-4.1-2.1.2.2.1"><code>hash-to-crv-suite</code>: <code>P256_XMD:SHA-256_SSWU_RO_</code> <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#section-4.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1-2.1.2.3">
                <p id="section-4.1-2.1.2.3.1"><code>DST_ext</code>: <code>'ARKG-P256ADD-ECDH'</code>.<a href="#section-4.1-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1"><code>KEM</code>: ECDH as described in <a href="#kem-ecdh" class="auto internal xref">Section 3.3</a> with the parameters:<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.2.2.1">
                <p id="section-4.1-2.2.2.1.1"><code>crv</code>: The NIST curve <code>secp256r1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1-2.2.2.2">
                <p id="section-4.1-2.2.2.2.1"><code>Hash</code>: SHA-256 [FIPS 180-4].<a href="#section-4.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1-2.2.2.3">
                <p id="section-4.1-2.2.2.3.1"><code>DST_ext</code>: <code>'ARKG-P256ADD-ECDH'</code>.<a href="#section-4.1-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="ARKG-P384ADD-ECDH">
<section id="section-4.2">
        <h3 id="name-arkg-p384add-ecdh">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-arkg-p384add-ecdh" class="section-name selfRef">ARKG-P384ADD-ECDH</a>
        </h3>
<p id="section-4.2-1">The identifier <code>ARKG-P384ADD-ECDH</code> represents the following ARKG instance:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">
            <p id="section-4.2-2.1.1"><code>BL</code>: Elliptic curve addition as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameters:<a href="#section-4.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1.2.1">
                <p id="section-4.2-2.1.2.1.1"><code>crv</code>: The NIST curve <code>secp384r1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.2-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2-2.1.2.2">
                <p id="section-4.2-2.1.2.2.1"><code>hash-to-crv-suite</code>: <code>P384_XMD:SHA-384_SSWU_RO_</code> <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#section-4.2-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2-2.1.2.3">
                <p id="section-4.2-2.1.2.3.1"><code>DST_ext</code>: <code>'ARKG-P384ADD-ECDH'</code>.<a href="#section-4.2-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.2-2.2">
            <p id="section-4.2-2.2.1"><code>KEM</code>: ECDH as described in <a href="#kem-ecdh" class="auto internal xref">Section 3.3</a> with the parameters:<a href="#section-4.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.2.2.1">
                <p id="section-4.2-2.2.2.1.1"><code>crv</code>: The NIST curve <code>secp384r1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2-2.2.2.2">
                <p id="section-4.2-2.2.2.2.1"><code>Hash</code>: SHA-384 [FIPS 180-4].<a href="#section-4.2-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2-2.2.2.3">
                <p id="section-4.2-2.2.2.3.1"><code>DST_ext</code>: <code>'ARKG-P384ADD-ECDH'</code>.<a href="#section-4.2-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="ARKG-P521ADD-ECDH">
<section id="section-4.3">
        <h3 id="name-arkg-p521add-ecdh">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-arkg-p521add-ecdh" class="section-name selfRef">ARKG-P521ADD-ECDH</a>
        </h3>
<p id="section-4.3-1">The identifier <code>ARKG-P521ADD-ECDH</code> represents the following ARKG instance:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.1">
            <p id="section-4.3-2.1.1"><code>BL</code>: Elliptic curve addition as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameters:<a href="#section-4.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.1.2.1">
                <p id="section-4.3-2.1.2.1.1"><code>crv</code>: The NIST curve <code>secp521r1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.3-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3-2.1.2.2">
                <p id="section-4.3-2.1.2.2.1"><code>hash-to-crv-suite</code>: <code>P521_XMD:SHA-512_SSWU_RO_</code> <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#section-4.3-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3-2.1.2.3">
                <p id="section-4.3-2.1.2.3.1"><code>DST_ext</code>: <code>'ARKG-P521ADD-ECDH'</code>.<a href="#section-4.3-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.3-2.2">
            <p id="section-4.3-2.2.1"><code>KEM</code>: ECDH as described in <a href="#kem-ecdh" class="auto internal xref">Section 3.3</a> with the parameters:<a href="#section-4.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.2.2.1">
                <p id="section-4.3-2.2.2.1.1"><code>crv</code>: The NIST curve <code>secp521r1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.3-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3-2.2.2.2">
                <p id="section-4.3-2.2.2.2.1"><code>Hash</code>: SHA-512 [FIPS 180-4].<a href="#section-4.3-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3-2.2.2.3">
                <p id="section-4.3-2.2.2.3.1"><code>DST_ext</code>: <code>'ARKG-P521ADD-ECDH'</code>.<a href="#section-4.3-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="ARKG-P256kADD-ECDH">
<section id="section-4.4">
        <h3 id="name-arkg-p256kadd-ecdh">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-arkg-p256kadd-ecdh" class="section-name selfRef">ARKG-P256kADD-ECDH</a>
        </h3>
<p id="section-4.4-1">The identifier <code>ARKG-P256kADD-ECDH</code> represents the following ARKG instance:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">
            <p id="section-4.4-2.1.1"><code>BL</code>: Elliptic curve addition as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameters:<a href="#section-4.4-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1.2.1">
                <p id="section-4.4-2.1.2.1.1"><code>crv</code>: The SECG curve <code>secp256k1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.4-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.4-2.1.2.2">
                <p id="section-4.4-2.1.2.2.1"><code>hash-to-crv-suite</code>: <code>secp256k1_XMD:SHA-256_SSWU_RO_</code> <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#section-4.4-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.4-2.1.2.3">
                <p id="section-4.4-2.1.2.3.1"><code>DST_ext</code>: <code>'ARKG-P256kADD-ECDH'</code>.<a href="#section-4.4-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.4-2.2">
            <p id="section-4.4-2.2.1"><code>KEM</code>: ECDH as described in <a href="#kem-ecdh" class="auto internal xref">Section 3.3</a> with the parameters:<a href="#section-4.4-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.2.2.1">
                <p id="section-4.4-2.2.2.1.1"><code>crv</code>: The SECG curve <code>secp256k1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.4-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.4-2.2.2.2">
                <p id="section-4.4-2.2.2.2.1"><code>Hash</code>: SHA-256 [FIPS 180-4].<a href="#section-4.4-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.4-2.2.2.3">
                <p id="section-4.4-2.2.2.3.1"><code>DST_ext</code>: <code>'ARKG-P256kADD-ECDH'</code>.<a href="#section-4.4-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="ARKG-curve25519ADD-X25519">
<section id="section-4.5">
        <h3 id="name-arkg-curve25519add-x25519">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-arkg-curve25519add-x25519" class="section-name selfRef">ARKG-curve25519ADD-X25519</a>
        </h3>
<p id="section-4.5-1">The identifier <code>ARKG-curve25519ADD-X25519</code> represents the following ARKG instance:<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-2.1">
            <p id="section-4.5-2.1.1"><code>BL</code>: Elliptic curve addition as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameters:<a href="#section-4.5-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-2.1.2.1">
                <p id="section-4.5-2.1.2.1.1"><code>crv</code>: The curve <code>curve25519</code> <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-4.5-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.5-2.1.2.2">
                <p id="section-4.5-2.1.2.2.1"><code>hash-to-crv-suite</code>: <code>curve25519_XMD:SHA-512_ELL2_RO_</code> <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#section-4.5-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.5-2.1.2.3">
                <p id="section-4.5-2.1.2.3.1"><code>DST_ext</code>: <code>'ARKG-curve25519ADD-X25519'</code>.<a href="#section-4.5-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.5-2.1.3">
WARNING: Some algorithms on curve25519, including X25519 <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>,
construct private key scalars within a particular range
to enable optimizations and constant-time guarantees.
This <code>BL</code> scheme does not guarantee that blinded private scalars remain in that range,
so implementations using this ARKG instance <span class="bcp14">MUST NOT</span> rely on such a guarantee.<a href="#section-4.5-2.1.3" class="pilcrow">¶</a></p>
<p id="section-4.5-2.1.4">
Note: Input and output keys of this <code>BL</code> scheme are curve scalars and curve points.
Some algorithms on curve25519, including X25519 <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>,
define the private key input as a random octet string and applies some preprocessing to it
before interpreting the result as a private key scalar,
and define public keys as a particular octet string encoding of a curve point.
This <code>BL</code> scheme is not compatible with such preprocessing
since it breaks the relationship between the blinded private key and the blinded public key.
Implementations using this ARKG instance <span class="bcp14">MUST</span> apply <code>BL-Blind-Private-Key</code>
to the interpreted private key scalar, not the random private key octet string,
and implementations of <code>BL-Blind-Public-Key</code> <span class="bcp14">MUST</span> interpret the public key input as a curve point,
not an opaque octet string.<a href="#section-4.5-2.1.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-2.2">
            <p id="section-4.5-2.2.1"><code>KEM</code>: X25519 as described in <a href="#kem-x25519-x448" class="auto internal xref">Section 3.4</a> with the parameters:<a href="#section-4.5-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-2.2.2.1">
                <p id="section-4.5-2.2.2.1.1"><code>DH-Function</code>: X25519 <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-4.5-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.5-2.2.2.2">
                <p id="section-4.5-2.2.2.2.1"><code>DST_ext</code>: <code>'ARKG-curve25519ADD-X25519'</code>.<a href="#section-4.5-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="ARKG-curve448ADD-X448">
<section id="section-4.6">
        <h3 id="name-arkg-curve448add-x448">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-arkg-curve448add-x448" class="section-name selfRef">ARKG-curve448ADD-X448</a>
        </h3>
<p id="section-4.6-1">The identifier <code>ARKG-curve448ADD-X448</code> represents the following ARKG instance:<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-2.1">
            <p id="section-4.6-2.1.1"><code>BL</code>: Elliptic curve addition as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameters:<a href="#section-4.6-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-2.1.2.1">
                <p id="section-4.6-2.1.2.1.1"><code>crv</code>: The curve <code>curve448</code> <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-4.6-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.6-2.1.2.2">
                <p id="section-4.6-2.1.2.2.1"><code>hash-to-crv-suite</code>: <code>curve448_XOF:SHAKE256_ELL2_RO_</code> <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#section-4.6-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.6-2.1.2.3">
                <p id="section-4.6-2.1.2.3.1"><code>DST_ext</code>: <code>'ARKG-curve448ADD-X448'</code>.<a href="#section-4.6-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.6-2.1.3">
WARNING: Some algorithms on curve25519, including X448 <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>,
construct private key scalars within a particular range
to enable optimizations and constant-time guarantees.
This <code>BL</code> scheme does not guarantee that blinded private scalars remain in that range,
so implementations using this ARKG instance <span class="bcp14">MUST NOT</span> rely on such a guarantee.<a href="#section-4.6-2.1.3" class="pilcrow">¶</a></p>
<p id="section-4.6-2.1.4">
Note: Input and output keys of this <code>BL</code> scheme are curve scalars and curve points.
Some algorithms on curve25519, including X448 <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>,
define the private key input as a random octet string and applies some preprocessing to it
before interpreting the result as a private key scalar,
and define public keys as a particular octet string encoding of a curve point.
This <code>BL</code> scheme is not compatible with such preprocessing
since it breaks the relationship between the blinded private key and the blinded public key.
Implementations using this ARKG instance <span class="bcp14">MUST</span> apply <code>BL-Blind-Private-Key</code>
to the interpreted private key scalar, not the random private key octet string,
and implementations of <code>BL-Blind-Public-Key</code> <span class="bcp14">MUST</span> interpret the public key input as a curve point,
not an opaque octet string.<a href="#section-4.6-2.1.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-2.2">
            <p id="section-4.6-2.2.1"><code>KEM</code>: X448 as described in <a href="#kem-x25519-x448" class="auto internal xref">Section 3.4</a> with the parameters:<a href="#section-4.6-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-2.2.2.1">
                <p id="section-4.6-2.2.2.1.1"><code>DH-Function</code>: X448 <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-4.6-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.6-2.2.2.2">
                <p id="section-4.6-2.2.2.2.1"><code>DST_ext</code>: <code>'ARKG-curve448ADD-X448'</code>.<a href="#section-4.6-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="ARKG-edwards25519ADD-X25519">
<section id="section-4.7">
        <h3 id="name-arkg-edwards25519add-x25519">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-arkg-edwards25519add-x25519" class="section-name selfRef">ARKG-edwards25519ADD-X25519</a>
        </h3>
<p id="section-4.7-1">The identifier <code>ARKG-edwards25519ADD-X25519</code> represents the following ARKG instance:<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-2.1">
            <p id="section-4.7-2.1.1"><code>BL</code>: Elliptic curve addition as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameters:<a href="#section-4.7-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-2.1.2.1">
                <p id="section-4.7-2.1.2.1.1"><code>crv</code>: The curve <code>edwards25519</code> <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-4.7-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.7-2.1.2.2">
                <p id="section-4.7-2.1.2.2.1"><code>hash-to-crv-suite</code>: <code>edwards25519_XMD:SHA-512_ELL2_RO_</code> <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#section-4.7-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.7-2.1.2.3">
                <p id="section-4.7-2.1.2.3.1"><code>DST_ext</code>: <code>'ARKG-edwards25519ADD-X25519'</code>.<a href="#section-4.7-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.7-2.1.3">
WARNING: Some algorithms on edwards25519, including EdDSA <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>,
construct private key scalars within a particular range
to enable optimizations and constant-time guarantees.
This <code>BL</code> scheme does not guarantee that blinded private scalars remain in that range,
so implementations using this ARKG instance <span class="bcp14">MUST NOT</span> rely on such a guarantee.<a href="#section-4.7-2.1.3" class="pilcrow">¶</a></p>
<p id="section-4.7-2.1.4">
Note: Input and output keys of this <code>BL</code> scheme are curve scalars and curve points.
Some algorithms on edwards25519, including EdDSA <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>,
define the private key input as a random octet string and applies some preprocessing to it
before interpreting the result as a private key scalar,
and define public keys as a particular octet string encoding of a curve point.
This <code>BL</code> scheme is not compatible with such preprocessing
since it breaks the relationship between the blinded private key and the blinded public key.
Implementations using this ARKG instance <span class="bcp14">MUST</span> apply <code>BL-Blind-Private-Key</code>
to the interpreted private key scalar, not the random private key octet string,
and implementations of <code>BL-Blind-Public-Key</code> <span class="bcp14">MUST</span> interpret the public key input as a curve point,
not an opaque octet string.<a href="#section-4.7-2.1.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-2.2">
            <p id="section-4.7-2.2.1"><code>KEM</code>: X25519 as described in <a href="#kem-x25519-x448" class="auto internal xref">Section 3.4</a> with the parameters:<a href="#section-4.7-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-2.2.2.1">
                <p id="section-4.7-2.2.2.1.1"><code>DH-Function</code>: X25519 <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-4.7-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.7-2.2.2.2">
                <p id="section-4.7-2.2.2.2.1"><code>DST_ext</code>: <code>'ARKG-edwards25519ADD-X25519'</code>.<a href="#section-4.7-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="ARKG-edwards448ADD-X448">
<section id="section-4.8">
        <h3 id="name-arkg-edwards448add-x448">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-arkg-edwards448add-x448" class="section-name selfRef">ARKG-edwards448ADD-X448</a>
        </h3>
<p id="section-4.8-1">The identifier <code>ARKG-edwards448ADD-X448</code> represents the following ARKG instance:<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8-2.1">
            <p id="section-4.8-2.1.1"><code>BL</code>: Elliptic curve addition as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameters:<a href="#section-4.8-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8-2.1.2.1">
                <p id="section-4.8-2.1.2.1.1"><code>crv</code>: The curve <code>edwards448</code> <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-4.8-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.8-2.1.2.2">
                <p id="section-4.8-2.1.2.2.1"><code>hash-to-crv-suite</code>: <code>edwards448_XOF:SHAKE256_ELL2_RO_</code> <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#section-4.8-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.8-2.1.2.3">
                <p id="section-4.8-2.1.2.3.1"><code>DST_ext</code>: <code>'ARKG-edwards448ADD-X448'</code>.<a href="#section-4.8-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.8-2.1.3">
WARNING: Some algorithms on edwards25519, including EdDSA <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>,
construct private key scalars within a particular range
to enable optimizations and constant-time guarantees.
This <code>BL</code> scheme does not guarantee that blinded private scalars remain in that range,
so implementations using this ARKG instance <span class="bcp14">MUST NOT</span> rely on such a guarantee.<a href="#section-4.8-2.1.3" class="pilcrow">¶</a></p>
<p id="section-4.8-2.1.4">
Note: Input and output keys of this <code>BL</code> scheme are curve scalars and curve points.
Some algorithms on edwards25519, including EdDSA <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>,
define the private key input as a random octet string and applies some preprocessing to it
before interpreting the result as a private key scalar,
and define public keys as a particular octet string encoding of a curve point.
This <code>BL</code> scheme is not compatible with such preprocessing
since it breaks the relationship between the blinded private key and the blinded public key.
Implementations using this ARKG instance <span class="bcp14">MUST</span> apply <code>BL-Blind-Private-Key</code>
to the interpreted private key scalar, not the random private key octet string,
and implementations of <code>BL-Blind-Public-Key</code> <span class="bcp14">MUST</span> interpret the public key input as a curve point,
not an opaque octet string.<a href="#section-4.8-2.1.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.8-2.2">
            <p id="section-4.8-2.2.1"><code>KEM</code>: X448 as described in <a href="#kem-x25519-x448" class="auto internal xref">Section 3.4</a> with the parameters:<a href="#section-4.8-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8-2.2.2.1">
                <p id="section-4.8-2.2.2.1.1"><code>DH-Function</code>: X448 <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-4.8-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.8-2.2.2.2">
                <p id="section-4.8-2.2.2.2.1"><code>DST_ext</code>: <code>'ARKG-edwards448ADD-X448'</code>.<a href="#section-4.8-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="cose">
<section id="section-5">
      <h2 id="name-cose-bindings">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-cose-bindings" class="section-name selfRef">COSE bindings</a>
      </h2>
<p id="section-5-1">This section proposes additions to COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span> to support ARKG use cases.
These consist of new key type definitions to represent ARKG public seeds
and references <span>[<a href="#I-D.lundberg-cose-2p-algs" class="cite xref">I-D.lundberg-cose-2p-algs</a>]</span> to private keys derived using ARKG.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="cose-arkg-pub-seed">
<section id="section-5.1">
        <h3 id="name-cose-key-type-arkg-public-s">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-cose-key-type-arkg-public-s" class="section-name selfRef">COSE key type: ARKG public seed</a>
        </h3>
<p id="section-5.1-1">An ARKG public seed is represented as a COSE_Key structure <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span>
with <code>kty</code> value TBD (placeholder value -65537).
<a href="#tbl-arkg-pub-params" class="auto internal xref">Table 1</a> defines key type parameters <code>pkbl</code> (-1) and <code>pkkem</code> (-2) for the <code>BL</code> and <code>KEM</code> public key, respectively,
as well as key type parameter <code>dkalg</code> (-3), representing the algorithm that derived public and private keys are to be used with.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<span id="name-cose-key-type-parameters-fo"></span><div id="tbl-arkg-pub-params">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-cose-key-type-parameters-fo" class="selfRef">COSE key type parameters for the ARKG-pub key type.</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Label</th>
              <th class="text-left" rowspan="1" colspan="1">Value type</th>
              <th class="text-left" rowspan="1" colspan="1">Required?</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">pkbl</td>
              <td class="text-left" rowspan="1" colspan="1">-1</td>
              <td class="text-left" rowspan="1" colspan="1">COSE_Key</td>
              <td class="text-left" rowspan="1" colspan="1">Required</td>
              <td class="text-left" rowspan="1" colspan="1">BL key of ARKG public seed</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">pkkem</td>
              <td class="text-left" rowspan="1" colspan="1">-2</td>
              <td class="text-left" rowspan="1" colspan="1">COSE_Key</td>
              <td class="text-left" rowspan="1" colspan="1">Required</td>
              <td class="text-left" rowspan="1" colspan="1">KEM key of ARKG public seed</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">dkalg</td>
              <td class="text-left" rowspan="1" colspan="1">-3</td>
              <td class="text-left" rowspan="1" colspan="1">int / tstr</td>
              <td class="text-left" rowspan="1" colspan="1">Optional</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>alg</code> parameter of public and private keys derived from this ARKG public seed</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-5.1-3">When <code>dkalg</code> (-3) is present in an ARKG public seed,
the <code>alg</code> (3) parameter of public keys derived using <code>ARKG-Derive-Public-Key</code> with that seed
<span class="bcp14">SHOULD</span> be set to the <code>dkalg</code> (-3) value of the seed.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">The <code>alg</code> (3) parameter, when present,
identifies the ARKG instance this public seed is to be used with.
<a href="#tbl-arkg-pub-algs" class="auto internal xref">Table 2</a> defines an initial set of COSE algorithm identifiers for this purpose.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<span id="name-cose-algorithm-identifiers-"></span><div id="tbl-arkg-pub-algs">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-cose-algorithm-identifiers-" class="selfRef">COSE algorithm identifiers to represent ARKG instances.</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ARKG-P256ADD-ECDH</td>
              <td class="text-left" rowspan="1" colspan="1">TBD (placeholder -65700)</td>
              <td class="text-left" rowspan="1" colspan="1">The ARKG instance defined in <a href="#ARKG-P256ADD-ECDH" class="auto internal xref">Section 4.1</a> of this document</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ARKG-P384ADD-ECDH</td>
              <td class="text-left" rowspan="1" colspan="1">TBD (placeholder -65701)</td>
              <td class="text-left" rowspan="1" colspan="1">The ARKG instance defined in <a href="#ARKG-P384ADD-ECDH" class="auto internal xref">Section 4.2</a> of this document</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ARKG-P521ADD-ECDH</td>
              <td class="text-left" rowspan="1" colspan="1">TBD (placeholder -65702)</td>
              <td class="text-left" rowspan="1" colspan="1">The ARKG instance defined in <a href="#ARKG-P521ADD-ECDH" class="auto internal xref">Section 4.3</a> of this document</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ARKG-P256kADD-ECDH</td>
              <td class="text-left" rowspan="1" colspan="1">TBD (placeholder -65703)</td>
              <td class="text-left" rowspan="1" colspan="1">The ARKG instance defined in <a href="#ARKG-P256kADD-ECDH" class="auto internal xref">Section 4.4</a> of this document</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ARKG-curve25519ADD-X25519</td>
              <td class="text-left" rowspan="1" colspan="1">TBD (placeholder -65704)</td>
              <td class="text-left" rowspan="1" colspan="1">The ARKG instance defined in <a href="#ARKG-curve25519ADD-X25519" class="auto internal xref">Section 4.5</a> of this document</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ARKG-curve448ADD-X448</td>
              <td class="text-left" rowspan="1" colspan="1">TBD (placeholder -65705)</td>
              <td class="text-left" rowspan="1" colspan="1">The ARKG instance defined in <a href="#ARKG-curve448ADD-X448" class="auto internal xref">Section 4.6</a> of this document</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ARKG-edwards25519ADD-X25519</td>
              <td class="text-left" rowspan="1" colspan="1">TBD (placeholder -65706)</td>
              <td class="text-left" rowspan="1" colspan="1">The ARKG instance defined in <a href="#ARKG-edwards25519ADD-X25519" class="auto internal xref">Section 4.7</a> of this document</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ARKG-edwards448ADD-X448</td>
              <td class="text-left" rowspan="1" colspan="1">TBD (placeholder -65707)</td>
              <td class="text-left" rowspan="1" colspan="1">The ARKG instance defined in <a href="#ARKG-edwards448ADD-X448" class="auto internal xref">Section 4.8</a> of this document</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-5.1-6">The following CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> example represents an <code>ARKG-P256ADD-ECDH</code> public seed
restricted to generating derived keys for use with the ESP256 <span>[<a href="#I-D.jose-fully-spec-algs" class="cite xref">I-D.jose-fully-spec-algs</a>]</span> signature algorithm:<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1-7">
<pre>
{
  1: -65537,   ; kty: ARKG-pub (placeholder value)
               ; kid: Opaque identifier
  2: h'60b6dfddd31659598ae5de49acb220d8
       704949e84d484b68344340e2565337d2',
  3: -65700,   ; alg: ARKG-P256ADD-ECDH (placeholder value)

  -1: {        ; BL public key
    1: 2,      ; kty: EC2
    -1: 1,     ; crv: P256
    -2: h'69380FC1C3B09652134FEEFBA61776F9
          7AF875CE46CA20252C4165102966EBC5',
    -3: h'8B515831462CCB0BD55CBA04BFD50DA6
          3FAF18BD845433622DAF97C06A10D0F1',
  },

  -2: {        ; KEM public key
    1: 2,      ; kty: EC2
    -1: 1,     ; crv: P256
    -2: h'5C099BEC31FAA581D14E208250D3FFDA
          9EC7F543043008BC84967A8D875B5D78',
    -3: h'539D57429FCB1C138DA29010A155DCA1
          4566A8F55AC2F1780810C49D4ED72D58',
  },

  -3: -9       ; Derived key algorithm: ESP256
}
</pre><a href="#section-5.1-7" class="pilcrow">¶</a>
</div>
<p id="section-5.1-8">The following is the same example encoded as CBOR:<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-9">
<pre>
h'a6013a0001000002582060b6dfddd31659598ae5de49acb220d8704949e84d48
  4b68344340e2565337d2033a000100a320a40102200121582069380fc1c3b096
  52134feefba61776f97af875ce46ca20252c4165102966ebc52258208b515831
  462ccb0bd55cba04bfd50da63faf18bd845433622daf97c06a10d0f121a40102
  20012158205c099bec31faa581d14e208250d3ffda9ec7f543043008bc84967a
  8d875b5d78225820539d57429fcb1c138da29010a155dca14566a8f55ac2f178
  0810c49d4ed72d582228'
</pre><a href="#section-5.1-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cose-arkg-derived-refs">
<section id="section-5.2">
        <h3 id="name-cose-key-reference-type-ark">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-cose-key-reference-type-ark" class="section-name selfRef">COSE key reference type: ARKG derived private key</a>
        </h3>
<p id="section-5.2-1">A reference to a private key derived using ARKG
may be represented as a <code>COSE_Key_Ref</code> structure <span>[<a href="#I-D.lundberg-cose-2p-algs" class="cite xref">I-D.lundberg-cose-2p-algs</a>]</span>
whose <code>kty</code> is <code>TBD</code> (Ref-ARKG-derived, placeholder -65538).
This key reference type defines key type parameters -1 and -2 respectively
for the <code>kh</code> and <code>info</code> parameters of <code>ARKG-Derive-Private-Key</code>.
The <code>kid</code> (2) parameter identifies the ARKG private seed <code>sk</code>.
Thus the <code>COSE_Key_Ref</code> structure conveys all arguments to use in <code>ARKG-Derive-Private-Key</code>
to derive the referenced private key.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2"><a href="#tbl-ref-arkg-params" class="auto internal xref">Table 3</a> defines key type parameters for the Ref-ARKG-derived key type.
A <code>COSE_Key_Ref</code> structure whose <code>kty</code> is TBD (Ref-ARKG-derived, placeholder -65538)
<span class="bcp14">MUST</span> include the parameters <code>kh</code> (-1) and <code>info</code> (-2).
The <code>inst</code> (-3) parameter <span class="bcp14">MAY</span> be used to indicate the ARKG instance
whose <code>ARKG-Derive-Private-Key</code> procedure to use to derive the private key;
its value is taken from the IANA "COSE Algorithms" registry <span>[<a href="#IANA.cose" class="cite xref">IANA.cose</a>]</span>
and an initial set of values is defined in <a href="#tbl-arkg-pub-params" class="auto internal xref">Table 1</a>.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">If <code>dkalg</code> (-3) is present in the ARKG public seed used in <code>ARKG-Derive-Public-Key</code> to generate the <code>kh</code> value,
then the <code>alg</code> (3) parameter of the COSE_Key_Ref <span class="bcp14">SHOULD</span> be set to the <code>dkalg</code> (-3) value of the seed.
If <code>alg</code> (3) is present in the seed,
then the <code>inst</code> (-3) parameter of the COSE_Key_Ref <span class="bcp14">SHOULD</span> be set to the <code>alg</code> (3) value of the seed.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<span id="name-cose-key-type-parameters-for"></span><div id="tbl-ref-arkg-params">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-cose-key-type-parameters-for" class="selfRef">COSE key type parameters for the Ref-ARKG-derived type.</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Label</th>
              <th class="text-left" rowspan="1" colspan="1">Value type</th>
              <th class="text-left" rowspan="1" colspan="1">Required?</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">kh</td>
              <td class="text-left" rowspan="1" colspan="1">-1</td>
              <td class="text-left" rowspan="1" colspan="1">bstr</td>
              <td class="text-left" rowspan="1" colspan="1">Required</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>kh</code> argument to <code>ARKG-Derive-Private-Key</code>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">info</td>
              <td class="text-left" rowspan="1" colspan="1">-2</td>
              <td class="text-left" rowspan="1" colspan="1">bstr</td>
              <td class="text-left" rowspan="1" colspan="1">Required</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>info</code> argument to <code>ARKG-Derive-Private-Key</code>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">inst</td>
              <td class="text-left" rowspan="1" colspan="1">-3</td>
              <td class="text-left" rowspan="1" colspan="1">int / tstr</td>
              <td class="text-left" rowspan="1" colspan="1">Optional</td>
              <td class="text-left" rowspan="1" colspan="1">COSE algorithm identifier of ARKG instance</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-5.2-5">The following CDDL example represents a reference to a key derived using <code>ARKG-P256ADD-ECDH</code>
and restricted for use with the ESP256 <span>[<a href="#I-D.jose-fully-spec-algs" class="cite xref">I-D.jose-fully-spec-algs</a>]</span> signature algorithm:<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.2-6">
<pre>
{
  1: -65538,   ; kty: Ref-ARKG-derived
               ; kid: Opaque identifier of ARKG-pub
  2: h'60b6dfddd31659598ae5de49acb220d8
       704949e84d484b68344340e2565337d2',
  3: -9,       ; alg: ESP256

               ; ARKG-P256ADD-ECDH key handle
               ; (HMAC-SHA-256-128 followed by
                  SEC1 uncompressed ECDH public key)
  -1: h'ae079e9c52212860678a7cee25b6a6d4
        048219d973768f8e1adb8eb84b220b0ee3
          a2532828b9aa65254fe3717a29499e9b
          aee70cea75b5c8a2ec2eb737834f7467
          e37b3254776f65f4cfc81e2bc4747a84',

               ; info argument to ARKG-Derive-Private-Key
  -2: 'Example application info',

  -3: -65700   ; inst: ARKG-P256ADD-ECDH (placeholder value)
}
</pre><a href="#section-5.2-6" class="pilcrow">¶</a>
</div>
<p id="section-5.2-7">The following is the same example encoded as CBOR:<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-8">
<pre>
h'a6013a0001000102582060b6dfddd31659598ae5de49acb220d8704949e84d48
  4b68344340e2565337d20328205851ae079e9c52212860678a7cee25b6a6d404
  8219d973768f8e1adb8eb84b220b0ee3a2532828b9aa65254fe3717a29499e9b
  aee70cea75b5c8a2ec2eb737834f7467e37b3254776f65f4cfc81e2bc4747a84
  2158184578616d706c65206170706c69636174696f6e20696e666f223a000100
  a3'
</pre><a href="#section-5.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">TODO<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Privacy">
<section id="section-7">
      <h2 id="name-privacy-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-7-1">TODO<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="cose-key-types-registrations">
<section id="section-8.1">
        <h3 id="name-cose-key-types-registration">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-cose-key-types-registration" class="section-name selfRef">COSE Key Types Registrations</a>
        </h3>
<p id="section-8.1-1">This section registers the following values in the IANA "COSE Key Types" registry <span>[<a href="#IANA.cose" class="cite xref">IANA.cose</a>]</span>.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-2.1">
            <p id="section-8.1-2.1.1">Name: ARKG-pub<a href="#section-8.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-2.1.2.1">
                <p id="section-8.1-2.1.2.1.1">Value: TBD (Placeholder -65537)<a href="#section-8.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.1-2.1.2.2">
                <p id="section-8.1-2.1.2.2.1">Description: ARKG public seed<a href="#section-8.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.1-2.1.2.3">
                <p id="section-8.1-2.1.2.3.1">Capabilities: [kty(-65537), pk_bl, pk_kem]<a href="#section-8.1-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.1-2.1.2.4">
                <p id="section-8.1-2.1.2.4.1">Reference: <a href="#cose-arkg-pub-seed" class="auto internal xref">Section 5.1</a> of this document<a href="#section-8.1-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.1-2.2">
            <p id="section-8.1-2.2.1">Name: Ref-ARKG-derived<a href="#section-8.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-2.2.2.1">
                <p id="section-8.1-2.2.2.1.1">Value: TBD (Placeholder -65538)<a href="#section-8.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.1-2.2.2.2">
                <p id="section-8.1-2.2.2.2.1">Description: Reference to private key derived by ARKG<a href="#section-8.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.1-2.2.2.3">
                <p id="section-8.1-2.2.2.3.1">Capabilities: [kty(-65538), kh, info]<a href="#section-8.1-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.1-2.2.2.4">
                <p id="section-8.1-2.2.2.4.1">Reference: <span>[<a href="#I-D.lundberg-cose-2p-algs" class="cite xref">I-D.lundberg-cose-2p-algs</a>]</span>, <a href="#cose-arkg-derived-refs" class="auto internal xref">Section 5.2</a> of this document<a href="#section-8.1-2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-8.1-3">These registrations add the following choices to the CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> type socket <code>$COSE_kty_ref</code> <span>[<a href="#I-D.lundberg-cose-2p-algs" class="cite xref">I-D.lundberg-cose-2p-algs</a>]</span>:<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-8.1-4">
<pre>
$COSE_kty_ref /= -65538   ; Placeholder value
</pre><a href="#section-8.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cose-key-type-parameters-registrations">
<section id="section-8.2">
        <h3 id="name-cose-key-type-parameters-re">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-cose-key-type-parameters-re" class="section-name selfRef">COSE Key Type Parameters Registrations</a>
        </h3>
<p id="section-8.2-1">This section registers the following values in the IANA "COSE Key Type Parameters" registry <span>[<a href="#IANA.cose" class="cite xref">IANA.cose</a>]</span>.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.1">
            <p id="section-8.2-2.1.1">Key Type: TBD (ARKG-pub, placeholder -65537)<a href="#section-8.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.1.2.1">
                <p id="section-8.2-2.1.2.1.1">Name: pk_bl<a href="#section-8.2-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.1.2.2">
                <p id="section-8.2-2.1.2.2.1">Label: -1<a href="#section-8.2-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.1.2.3">
                <p id="section-8.2-2.1.2.3.1">CBOR Type: COSE_Key<a href="#section-8.2-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.1.2.4">
                <p id="section-8.2-2.1.2.4.1">Description: ARKG key blinding public key<a href="#section-8.2-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.1.2.5">
                <p id="section-8.2-2.1.2.5.1">Reference: <a href="#cose-arkg-pub-seed" class="auto internal xref">Section 5.1</a> of this document<a href="#section-8.2-2.1.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.2-2.2">
            <p id="section-8.2-2.2.1">Key Type: TBD (ARKG-pub, placeholder -65537)<a href="#section-8.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.2.2.1">
                <p id="section-8.2-2.2.2.1.1">Name: pk_kem<a href="#section-8.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.2.2.2">
                <p id="section-8.2-2.2.2.2.1">Label: -2<a href="#section-8.2-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.2.2.3">
                <p id="section-8.2-2.2.2.3.1">CBOR Type: COSE_Key<a href="#section-8.2-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.2.2.4">
                <p id="section-8.2-2.2.2.4.1">Description: ARKG key encapsulation public key<a href="#section-8.2-2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.2.2.5">
                <p id="section-8.2-2.2.2.5.1">Reference: <a href="#cose-arkg-pub-seed" class="auto internal xref">Section 5.1</a> of this document<a href="#section-8.2-2.2.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.2-2.3">
            <p id="section-8.2-2.3.1">Key Type: TBD (Ref-ARKG-derived, placeholder -65538)<a href="#section-8.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.3.2.1">
                <p id="section-8.2-2.3.2.1.1">Name: kh<a href="#section-8.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.3.2.2">
                <p id="section-8.2-2.3.2.2.1">Label: -1<a href="#section-8.2-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.3.2.3">
                <p id="section-8.2-2.3.2.3.1">CBOR Type: bstr<a href="#section-8.2-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.3.2.4">
                <p id="section-8.2-2.3.2.4.1">Description: kh argument to ARKG-Derive-Private-Key<a href="#section-8.2-2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.3.2.5">
                <p id="section-8.2-2.3.2.5.1">Reference: <span>[<a href="#I-D.lundberg-cose-2p-algs" class="cite xref">I-D.lundberg-cose-2p-algs</a>]</span>, <a href="#cose-arkg-derived-refs" class="auto internal xref">Section 5.2</a> of this document<a href="#section-8.2-2.3.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.2-2.4">
            <p id="section-8.2-2.4.1">Key Type: TBD (Ref-ARKG-derived, placeholder -65538)<a href="#section-8.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.4.2.1">
                <p id="section-8.2-2.4.2.1.1">Name: info<a href="#section-8.2-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.4.2.2">
                <p id="section-8.2-2.4.2.2.1">Label: -2<a href="#section-8.2-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.4.2.3">
                <p id="section-8.2-2.4.2.3.1">CBOR Type: bstr<a href="#section-8.2-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.4.2.4">
                <p id="section-8.2-2.4.2.4.1">Description: info argument to ARKG-Derive-Private-Key<a href="#section-8.2-2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2-2.4.2.5">
                <p id="section-8.2-2.4.2.5.1">Reference: <span>[<a href="#I-D.lundberg-cose-2p-algs" class="cite xref">I-D.lundberg-cose-2p-algs</a>]</span>, <a href="#cose-arkg-derived-refs" class="auto internal xref">Section 5.2</a> of this document<a href="#section-8.2-2.4.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="cose-algorithms-registrations">
<section id="section-8.3">
        <h3 id="name-cose-algorithms-registratio">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-cose-algorithms-registratio" class="section-name selfRef">COSE Algorithms Registrations</a>
        </h3>
<p id="section-8.3-1">This section registers the following values in the IANA "COSE Algorithms" registry <span>[<a href="#IANA.cose" class="cite xref">IANA.cose</a>]</span>.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.1">
            <p id="section-8.3-2.1.1">Name: ARKG-P256ADD-ECDH<a href="#section-8.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.1.2.1">
                <p id="section-8.3-2.1.2.1.1">Value: TBD (placeholder -65700)<a href="#section-8.3-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.1.2.2">
                <p id="section-8.3-2.1.2.2.1">Description: ARKG using ECDH and additive blinding on secp256r1<a href="#section-8.3-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.1.2.3">
                <p id="section-8.3-2.1.2.3.1">Reference: <a href="#ARKG-P256ADD-ECDH" class="auto internal xref">Section 4.1</a> of this document<a href="#section-8.3-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.1.2.4">
                <p id="section-8.3-2.1.2.4.1">Recommended: TBD<a href="#section-8.3-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.3-2.2">
            <p id="section-8.3-2.2.1">Name: ARKG-P384ADD-ECDH<a href="#section-8.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.2.2.1">
                <p id="section-8.3-2.2.2.1.1">Value: TBD (placeholder -65701)<a href="#section-8.3-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.2.2.2">
                <p id="section-8.3-2.2.2.2.1">Description: ARKG using ECDH and additive blinding on secp384r1<a href="#section-8.3-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.2.2.3">
                <p id="section-8.3-2.2.2.3.1">Reference: <a href="#ARKG-P384ADD-ECDH" class="auto internal xref">Section 4.2</a> of this document<a href="#section-8.3-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.2.2.4">
                <p id="section-8.3-2.2.2.4.1">Recommended: TBD<a href="#section-8.3-2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.3-2.3">
            <p id="section-8.3-2.3.1">Name: ARKG-P521ADD-ECDH<a href="#section-8.3-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.3.2.1">
                <p id="section-8.3-2.3.2.1.1">Value: TBD (placeholder -65702)<a href="#section-8.3-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.3.2.2">
                <p id="section-8.3-2.3.2.2.1">Description: ARKG using ECDH and additive blinding on secp521r1<a href="#section-8.3-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.3.2.3">
                <p id="section-8.3-2.3.2.3.1">Reference: <a href="#ARKG-P521ADD-ECDH" class="auto internal xref">Section 4.3</a> of this document<a href="#section-8.3-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.3.2.4">
                <p id="section-8.3-2.3.2.4.1">Recommended: TBD<a href="#section-8.3-2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.3-2.4">
            <p id="section-8.3-2.4.1">Name: ARKG-P256kADD-ECDH<a href="#section-8.3-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.4.2.1">
                <p id="section-8.3-2.4.2.1.1">Value: TBD (placeholder -65703)<a href="#section-8.3-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.4.2.2">
                <p id="section-8.3-2.4.2.2.1">Description: ARKG using ECDH and additive blinding on secp256k1<a href="#section-8.3-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.4.2.3">
                <p id="section-8.3-2.4.2.3.1">Reference: <a href="#ARKG-P256kADD-ECDH" class="auto internal xref">Section 4.4</a> of this document<a href="#section-8.3-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.4.2.4">
                <p id="section-8.3-2.4.2.4.1">Recommended: TBD<a href="#section-8.3-2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.3-2.5">
            <p id="section-8.3-2.5.1">Name: ARKG-curve25519ADD-X25519<a href="#section-8.3-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.5.2.1">
                <p id="section-8.3-2.5.2.1.1">Value: TBD (placeholder -65704)<a href="#section-8.3-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.5.2.2">
                <p id="section-8.3-2.5.2.2.1">Description: ARKG using X25519 and additive blinding on curve25519<a href="#section-8.3-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.5.2.3">
                <p id="section-8.3-2.5.2.3.1">Reference: <a href="#ARKG-curve25519ADD-X25519" class="auto internal xref">Section 4.5</a> of this document<a href="#section-8.3-2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.5.2.4">
                <p id="section-8.3-2.5.2.4.1">Recommended: TBD<a href="#section-8.3-2.5.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.3-2.6">
            <p id="section-8.3-2.6.1">Name: ARKG-curve448ADD-X448<a href="#section-8.3-2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.6.2.1">
                <p id="section-8.3-2.6.2.1.1">Value: TBD (placeholder -65705)<a href="#section-8.3-2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.6.2.2">
                <p id="section-8.3-2.6.2.2.1">Description: ARKG using X448 and additive blinding on curve448<a href="#section-8.3-2.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.6.2.3">
                <p id="section-8.3-2.6.2.3.1">Reference: <a href="#ARKG-curve448ADD-X448" class="auto internal xref">Section 4.6</a> of this document<a href="#section-8.3-2.6.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.6.2.4">
                <p id="section-8.3-2.6.2.4.1">Recommended: TBD<a href="#section-8.3-2.6.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.3-2.7">
            <p id="section-8.3-2.7.1">Name: ARKG-edwards25519ADD-X25519<a href="#section-8.3-2.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.7.2.1">
                <p id="section-8.3-2.7.2.1.1">Value: TBD (placeholder -65706)<a href="#section-8.3-2.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.7.2.2">
                <p id="section-8.3-2.7.2.2.1">Description: ARKG using X25519 and additive blinding on edwards25519<a href="#section-8.3-2.7.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.7.2.3">
                <p id="section-8.3-2.7.2.3.1">Reference: <a href="#ARKG-edwards25519ADD-X25519" class="auto internal xref">Section 4.7</a> of this document<a href="#section-8.3-2.7.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.7.2.4">
                <p id="section-8.3-2.7.2.4.1">Recommended: TBD<a href="#section-8.3-2.7.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.3-2.8">
            <p id="section-8.3-2.8.1">Name: ARKG-edwards448ADD-X448<a href="#section-8.3-2.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.8.2.1">
                <p id="section-8.3-2.8.2.1.1">Value: TBD (placeholder -65707)<a href="#section-8.3-2.8.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.8.2.2">
                <p id="section-8.3-2.8.2.2.1">Description: ARKG using X448 and additive blinding on edwards448<a href="#section-8.3-2.8.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.8.2.3">
                <p id="section-8.3-2.8.2.3.1">Reference: <a href="#ARKG-edwards448ADD-X448" class="auto internal xref">Section 4.8</a> of this document<a href="#section-8.3-2.8.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-2.8.2.4">
                <p id="section-8.3-2.8.2.4.1">Recommended: TBD<a href="#section-8.3-2.8.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="design-rationale">
<section id="section-9">
      <h2 id="name-design-rationale">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-design-rationale" class="section-name selfRef">Design rationale</a>
      </h2>
<div id="design-rationale-mac">
<section id="section-9.1">
        <h3 id="name-using-a-mac">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-using-a-mac" class="section-name selfRef">Using a MAC</a>
        </h3>
<p id="section-9.1-1">The ARKG construction by Wilson <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span> omits the MAC and instead encodes application context in the PRF labels,
arguing that this leads to invalid keys/signatures in cases that would have a bad MAC.
We choose to keep the MAC from the construction by Frymann et al. <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span>,
but allow it to be omitted in case the chosen KEM already guarantees ciphertext integrity.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">The reason for this is to ensure that the delegating party can distinguish key handles that belong to its ARKG seed.
For example, this is important for applications using the W3C Web Authentication API [WebAuthn],
which do not know beforehand which authenticators are connected and available.
Instead, authentication requests may include references to several eligible authenticators,
and the one to use is chosen opportunistically by the WebAuthn client depending on which are available at the time.
Consider using ARKG in such a scenario to sign some data with a derived private key:
a user may have several authenticators and thus several ARKG seeds,
so the signing request might include several well-formed ARKG key handles,
but only one of them belongs to the ARKG seed of the authenticator that is currently connected.
Without an integrity check,
choosing the wrong key handle might cause the <code>ARKG-Derive-Private-Key</code> procedure to silently derive the wrong key
instead of returning an explicit error, which would in turn lead to an invalid signature or similar final output.
This would make it difficult or impossible to diagnose the root cause of the issue and present actionable user feedback.
For this reason, we require the KEM to guarantee ciphertext integrity
so that <code>ARKG-Derive-Private-Key</code> can fail early if the key handle belongs to a different ARKG seed.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">It is straightforward to see that adding the MAC to the construction by Wilson
does not weaken the security properties defined by Frymann et al. <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span>:
the construction by Frymann et al. can be reduced to the ARKG construction in this document
by instantiating <code>BL</code> as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a>
and <code>KEM</code> as described in <a href="#kem-ecdh" class="auto internal xref">Section 3.3</a>.
The use of hash_to_field in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> corresponds to the KDF<sub>1</sub> parameter in <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span>,
and the use of HMAC and HKDF in <a href="#hmac-kem" class="auto internal xref">Section 3.2</a> corresponds to the MAC and KDF<sub>2</sub> parameters in <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span>.
Hence if one can break PK-unlinkability or SK-security of the ARKG construction in this document,
one can also break the same property of the construction by Frymann et al.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-status">
<section id="section-9.2">
        <h3 id="name-implementation-status">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
        </h3>
<p id="section-9.2-1">TODO<a href="#section-9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.jose-fully-spec-algs">[I-D.jose-fully-spec-algs]</dt>
        <dd>
<span class="refAuthor">Jones, M. B.</span> and <span class="refAuthor">O. Steele</span>, <span class="refTitle">"Fully-Specified Algorithms for JOSE and COSE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-jose-fully-specified-algorithms-07</span>, <time datetime="2025-02-20" class="refDate">20 February 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-jose-fully-specified-algorithms-07">https://datatracker.ietf.org/doc/html/draft-ietf-jose-fully-specified-algorithms-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.lundberg-cose-2p-algs">[I-D.lundberg-cose-2p-algs]</dt>
        <dd>
<span class="refAuthor">Lundberg, E.</span> and <span class="refAuthor">M. B. Jones</span>, <span class="refTitle">"COSE Algorithms for Two-Party Signing"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-lundberg-cose-two-party-signing-algs-01</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-lundberg-cose-two-party-signing-algs-01">https://datatracker.ietf.org/doc/html/draft-lundberg-cose-two-party-signing-algs-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.cose">[IANA.cose]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose">https://www.iana.org/assignments/cose</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2104">https://www.rfc-editor.org/rfc/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[RFC4949]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4949">https://www.rfc-editor.org/rfc/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5869">https://www.rfc-editor.org/rfc/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6090">[RFC6090]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Igoe, K.</span>, and <span class="refAuthor">M. Salter</span>, <span class="refTitle">"Fundamental Elliptic Curve Cryptography Algorithms"</span>, <span class="seriesInfo">RFC 6090</span>, <span class="seriesInfo">DOI 10.17487/RFC6090</span>, <time datetime="2011-02" class="refDate">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6090">https://www.rfc-editor.org/rfc/rfc6090</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7748">https://www.rfc-editor.org/rfc/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8812">[RFC8812]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE) and JSON Object Signing and Encryption (JOSE) Registrations for Web Authentication (WebAuthn) Algorithms"</span>, <span class="seriesInfo">RFC 8812</span>, <span class="seriesInfo">DOI 10.17487/RFC8812</span>, <time datetime="2020-08" class="refDate">August 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8812">https://www.rfc-editor.org/rfc/rfc8812</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9380">[RFC9380]</dt>
        <dd>
<span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R. S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="seriesInfo">RFC 9380</span>, <span class="seriesInfo">DOI 10.17487/RFC9380</span>, <time datetime="2023-08" class="refDate">August 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9380">https://www.rfc-editor.org/rfc/rfc9380</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC1">[SEC1]</dt>
        <dd>
<span class="refAuthor">Certicom Research</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography"</span>, <time datetime="2009" class="refDate">2009</time>, <span>&lt;<a href="http://www.secg.org/sec1-v2.pdf">http://www.secg.org/sec1-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC2">[SEC2]</dt>
      <dd>
<span class="refAuthor">Certicom Research</span>, <span class="refTitle">"SEC 2: Recommended Elliptic Curve Domain Parameters"</span>, <time datetime="2010" class="refDate">2010</time>, <span>&lt;<a href="http://www.secg.org/sec2-v2.pdf">http://www.secg.org/sec2-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BIP32">[BIP32]</dt>
        <dd>
<span class="refAuthor">Wuille, P.</span>, <span class="refTitle">"BIP 32 Hierarchical Deterministic Wallets"</span>, <time datetime="2012" class="refDate">2012</time>, <span>&lt;<a href="https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki">https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Clermont">[Clermont]</dt>
        <dd>
<span class="refAuthor">Clermont, S. A.</span>, <span class="refTitle">"Post Quantum Asynchronous Remote Key Generation. Master's thesis"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://www.cryptoplexity.informatik.tu-darmstadt.de/media/crypt/teaching_1/theses_1/Sebastian_Clermont_Thesis.pdf">https://www.cryptoplexity.informatik.tu-darmstadt.de/media/crypt/teaching_1/theses_1/Sebastian_Clermont_Thesis.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Frymann2020">[Frymann2020]</dt>
        <dd>
<span class="refAuthor">Frymann, N.</span>, <span class="refAuthor">Gardham, D.</span>, <span class="refAuthor">Kiefer, F.</span>, <span class="refAuthor">Lundberg, E.</span>, <span class="refAuthor">Manulis, M.</span>, and <span class="refAuthor">D. Nilsson</span>, <span class="refTitle">"Asynchronous Remote Key Generation: An Analysis of Yubico's Proposal for W3C WebAuthn. CCS '20: Proceedings of the 2020 ACM SIGSAC Conference on Computer and Communications Security"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://eprint.iacr.org/2020/1004">https://eprint.iacr.org/2020/1004</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Frymann2023">[Frymann2023]</dt>
        <dd>
<span class="refAuthor">Frymann, N.</span>, <span class="refAuthor">Gardham, D.</span>, and <span class="refAuthor">M. Manulis</span>, <span class="refTitle">"Asynchronous Remote Key Generation for Post-Quantum Cryptosystems from Lattices. 2023 IEEE 8th European Symposium on Security and Privacy"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://eprint.iacr.org/2023/419">https://eprint.iacr.org/2023/419</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Shoup">[Shoup]</dt>
        <dd>
<span class="refAuthor">Shoup, V.</span>, <span class="refTitle">"A Proposal for an ISO Standard for Public Key Encryption (version 2.0)"</span>, <time datetime="2001" class="refDate">2001</time>, <span>&lt;<a href="https://www.shoup.net/papers/iso-2.pdf">https://www.shoup.net/papers/iso-2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WebAuthn-Recovery">[WebAuthn-Recovery]</dt>
        <dd>
<span class="refAuthor">Lundberg, E.</span> and <span class="refAuthor">D. Nilsson</span>, <span class="refTitle">"WebAuthn recovery extension: Asynchronous delegated key generation without shared secrets. GitHub"</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://github.com/Yubico/webauthn-recovery-extension">https://github.com/Yubico/webauthn-recovery-extension</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Wilson">[Wilson]</dt>
      <dd>
<span class="refAuthor">Wilson, S. M.</span>, <span class="refTitle">"Post-Quantum Account Recovery for Passwordless Authentication. Master's thesis"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="http://hdl.handle.net/10012/19316">http://hdl.handle.net/10012/19316</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">ARKG was first proposed under this name by Frymann et al. <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span>,
who analyzed a proposed extension to W3C Web Authentication by Lundberg and Nilsson <span>[<a href="#WebAuthn-Recovery" class="cite xref">WebAuthn-Recovery</a>]</span>,
which was in turn inspired by a similar construction by Wuille <span>[<a href="#BIP32" class="cite xref">BIP32</a>]</span> used to create privacy-preserving Bitcoin addresses.
Frymann et al. <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span> generalized the constructions by Lundberg, Nilsson and Wuille
from elliptic curves to any discrete logarithm (DL) problem,
and also proved the security of arbitrary asymmetric protocols composed with ARKG.
Further generalizations to include quantum-resistant instantiations
were developed independently by Clermont <span>[<a href="#Clermont" class="cite xref">Clermont</a>]</span>, Frymann et al. <span>[<a href="#Frymann2023" class="cite xref">Frymann2023</a>]</span> and Wilson <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">This document adopts the construction proposed by Wilson <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span>,
modified by the inclusion of a MAC in the key handles as done in the original construction by Frymann et al. <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span>.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">The authors would like to thank all of these authors for their research and development work that led to the creation of this document.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="test-vectors">
<section id="appendix-B">
      <h2 id="name-test-vectors">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="appendix-B-1">TODO<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-C">
      <h2 id="name-document-history">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-C-1">-00<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">
          <p id="appendix-C-2.1.1">Initial Version<a href="#appendix-C-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-3">-01<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1">
          <p id="appendix-C-4.1.1">Editorial Fixes to formatting and references.<a href="#appendix-C-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-5">-02<a href="#appendix-C-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-6.1">
          <p id="appendix-C-6.1.1">Rewritten introduction.<a href="#appendix-C-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-6.2">
          <p id="appendix-C-6.2.1">Renamed ARKG-Derive-Secret-Key to ARKG-Derive-Private-Key.<a href="#appendix-C-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-6.3">
          <p id="appendix-C-6.3.1">Overhauled EC instantiations to use hash_to_field and account for non-prime order curve key generation.<a href="#appendix-C-6.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-6.4">
          <p id="appendix-C-6.4.1">Eliminated top-level MAC and KDF instance parameters.<a href="#appendix-C-6.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-6.5">
          <p id="appendix-C-6.5.1">Added info parameter to instance parameter functions.<a href="#appendix-C-6.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-6.6">
          <p id="appendix-C-6.6.1">Added requirement of KEM ciphertext integrity and generic formula for augmenting any KEM using HMAC.<a href="#appendix-C-6.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-6.7">
          <p id="appendix-C-6.7.1">Added curve/edwards25519/448 instances.<a href="#appendix-C-6.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-6.8">
          <p id="appendix-C-6.8.1">Added proposal for COSE bindings and key reference types.<a href="#appendix-C-6.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-7">-03<a href="#appendix-C-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-8.1">
          <p id="appendix-C-8.1.1">Renamed section "Using HMAC to adapt a KEM without {integrity protection =&gt; ciphertext integrity}".<a href="#appendix-C-8.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-8.2">
          <p id="appendix-C-8.2.1">Fixed info argument to HMAC in section "Using HMAC to adapt a KEM without ciphertext integrity".<a href="#appendix-C-8.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-8.3">
          <p id="appendix-C-8.3.1">Added reference to Shoup for definition of key encapsulation mechanism.<a href="#appendix-C-8.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-8.4">
          <p id="appendix-C-8.4.1">Added CDDL definition of COSE_Key_Ref<a href="#appendix-C-8.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-8.5">
          <p id="appendix-C-8.5.1">Editorial fixes to references.<a href="#appendix-C-8.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-8.6">
          <p id="appendix-C-8.6.1">Renamed proposed COSE Key Types.<a href="#appendix-C-8.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-9">-04<a href="#appendix-C-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-10.1">
          <p id="appendix-C-10.1.1">Extracted COSE_Key_Ref definition and COSE algorithm registrations to draft-lundberg-cose-two-party-signing-algs.<a href="#appendix-C-10.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-10.2">
          <p id="appendix-C-10.2.1">Redefined alg (3) parameter and added dkalg (-3) in ARKG-pub COSE_Key<a href="#appendix-C-10.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-10.3">
          <p id="appendix-C-10.3.1">Defined alg (3) and inst (-3) parameters of Ref-ARKG-derived COSE key type<a href="#appendix-C-10.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="contributors">
<section id="appendix-D">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dain Nilsson</span></div>
<div dir="auto" class="left"><span class="org">Yubico</span></div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Peter Altmann</span></div>
<div dir="auto" class="left"><span class="org">Agency for Digital Government</span></div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael B. Jones</span></div>
<div dir="auto" class="left"><span class="org">Self-Issued Consulting</span></div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="url">
<span>URI:</span>
<a href="https://self-issued.info/" class="url">https://self-issued.info/</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Emil Lundberg (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Yubico</span></div>
<div dir="auto" class="left"><span class="street-address">Gävlegatan 22</span></div>
<div dir="auto" class="left"><span class="locality">Stockholm</span></div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:emil@emlun.se" class="email">emil@emlun.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Bradley</span></div>
<div dir="auto" class="left"><span class="org">Yubico</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ve7jtb@ve7jtb.com" class="email">ve7jtb@ve7jtb.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
