<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The Asynchronous Remote Key Generation (ARKG) algorithm</title>
<meta content="Emil Lundberg" name="author">
<meta content="John Bradley" name="author">
<meta content="
       Asynchronous Remote Key Generation (ARKG) is an abstract algorithm
that enables delegation of asymmetric public key generation without giving access to the corresponding private keys.
This capability enables a variety of applications:
a user agent can generate pseudonymous public keys to prevent tracking;
a message sender can generate ephemeral recipient public keys to enhance forward secrecy;
two paired authentication devices can each have their own private keys while each can register public keys on behalf of the other. 
       This document provides three main contributions:
a specification of the generic ARKG algorithm using abstract primitives;
a set of formulae for instantiating the abstract primitives using concrete primitives;
and an initial set of fully specified concrete ARKG instances.
We expect that additional instances will be defined in the future. 
    " name="description">
<meta content="xml2rfc 3.21.0" name="generator">
<meta content="KDF" name="keyword">
<meta content="draft-bradleylundberg-cfrg-arkg-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.11.9
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 4.2.0
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 68.2.2
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-bradleylundberg-cfrg-arkg.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">ARKG</td>
<td class="right">May 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Lundberg &amp; Bradley</td>
<td class="center">Expires 3 November 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Crypto Forum</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-bradleylundberg-cfrg-arkg-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-05-02" class="published">2 May 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-11-03">3 November 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">E. Lundberg, <span class="editor">Ed.</span>
</div>
<div class="org">Yubico</div>
</div>
<div class="author">
      <div class="author-name">J. Bradley</div>
<div class="org">Yubico</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The Asynchronous Remote Key Generation (ARKG) algorithm</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Asynchronous Remote Key Generation (ARKG) is an abstract algorithm
that enables delegation of asymmetric public key generation without giving access to the corresponding private keys.
This capability enables a variety of applications:
a user agent can generate pseudonymous public keys to prevent tracking;
a message sender can generate ephemeral recipient public keys to enhance forward secrecy;
two paired authentication devices can each have their own private keys while each can register public keys on behalf of the other.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document provides three main contributions:
a specification of the generic ARKG algorithm using abstract primitives;
a set of formulae for instantiating the abstract primitives using concrete primitives;
and an initial set of fully specified concrete ARKG instances.
We expect that additional instances will be defined in the future.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-bradleylundberg-cfrg-arkg/">https://datatracker.ietf.org/doc/draft-bradleylundberg-cfrg-arkg/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/Yubico/arkg-rfc">https://github.com/Yubico/arkg-rfc</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 3 November 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-notation" class="internal xref">Notation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-the-asynchronous-remote-key" class="internal xref">The Asynchronous Remote Key Generation (ARKG) algorithm</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-instance-parameters" class="internal xref">Instance parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-the-function-arkg-generate-" class="internal xref">The function ARKG-Generate-Seed</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-deterministic-key-generatio" class="internal xref">Deterministic key generation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-the-function-arkg-derive-pu" class="internal xref">The function ARKG-Derive-Public-Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-the-function-arkg-derive-se" class="internal xref">The function ARKG-Derive-Secret-Key</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-generic-arkg-instantiations" class="internal xref">Generic ARKG instantiations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-using-elliptic-curve-arithm" class="internal xref">Using elliptic curve arithmetic for key blinding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-using-ecdh-as-the-kem" class="internal xref">Using ECDH as the KEM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-using-the-same-key-for-both" class="internal xref">Using the same key for both key blinding and KEM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-using-hmac-as-the-mac" class="internal xref">Using HMAC as the MAC</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-using-hkdf-as-the-kdf" class="internal xref">Using HKDF as the KDF</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-concrete-arkg-instantiation" class="internal xref">Concrete ARKG instantiations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-arkg-p256-ecdh-p256-hmac-sh" class="internal xref">ARKG-P256-ECDH-P256-HMAC-SHA256-HKDF-SHA256</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-arkg-p384-ecdh-p384-hmac-sh" class="internal xref">ARKG-P384-ECDH-P384-HMAC-SHA384-HKDF-SHA384</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-arkg-p521-ecdh-p521-hmac-sh" class="internal xref">ARKG-P521-ECDH-P521-HMAC-SHA512-HKDF-SHA512</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-arkg-p256k-ecdh-p256k-hmac-" class="internal xref">ARKG-P256k-ECDH-P256k-HMAC-SHA256-HKDF-SHA256</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-arkg-ed25519-x25519-hmac-sh" class="internal xref">ARKG-Ed25519-X25519-HMAC-SHA256-HKDF-SHA256</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-arkg-x25519-x25519-hmac-sha" class="internal xref">ARKG-X25519-X25519-HMAC-SHA256-HKDF-SHA256</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-cose-bindings" class="internal xref">COSE bindings</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-design-rationale" class="internal xref">Design rationale</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-using-a-mac" class="internal xref">Using a MAC</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Asynchronous Remote Key Generation (ARKG) introduces a mechanism
to generate public keys without access to the corresponding private keys.
Such a mechanism is useful for many scenarios when a new public key is needed
but the private key holder is not available to perform the key generation.
This may occur when private keys are stored in a hardware security device,
which may be unavailable or locked at the time a new public key is needed.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Some motivating use cases of ARKG include:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
          <p id="section-1-3.1.1"><strong>Single-use asymmetric keys</strong>:
Envisioned for the European Union's digital identity framework,
which is set to use single-use asymmetric keys to prevent colluding verifiers from using public keys as correlation handles.
Each digital identity credential would thus be issued with a single-use proof-of-possession key,
used only once to present the credential to a verifier.
ARKG empowers both online and offline usage scenarios:
for offline scenarios, ARKG enables pre-generation of public keys for single-use credentials
without needing to access the hardware security device that holds the private keys.
For online scenarios, ARKG gives the credential issuer assurance
that all derived private keys are bound to the same secure hardware element.
In both cases, application performance may be improved
since public keys can be generated in a general-purpose execution environment instead of a secure enclave.<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.2">
          <p id="section-1-3.2.1"><strong>Enhanced forward secrecy</strong>:
The use of ARKG can facilitate forward secrecy in certain contexts.
For instance, <a href="https://www.rfc-editor.org/rfc/rfc9052.html#name-direct-key-agreement">section 8.5.4 of RFC 9052</a> notes that
"Since COSE is designed for a store-and-forward environment rather than an online environment,
[...] forward secrecy (see <span>[<a href="#RFC4949" class="cite xref">RFC4949</a>]</span>) is not achievable. A static key will always be used for the receiver of the COSE object."
As opposed to workarounds like exchanging a large number of keys in advance,
ARKG enables the the sender to generate ephemeral recipient public keys on demand.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.3">
          <p id="section-1-3.3.1"><strong>Backup key generation</strong>:
For example, the W3C Web Authentication API [WebAuthn] (WebAuthn) generates a new key pair for each account on each web site.
ARKG could allow for simultaneously generating a backup public key when registering a new public key.
A primary authenticator could generate both a key pair for itself and a public key for a paired backup authenticator.
The backup authenticator only needs to be paired with the primary authenticator once,
and can then be safely stored until it is needed.<a href="#section-1-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-4">ARKG consists of three procedures:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">
          <p id="section-1-5.1.1"><strong>Initialization</strong>:
The <em>delegating party</em> generates a <em>seed pair</em> and discloses the <em>public seed</em> to a <em>subordinate party</em>,
while securely retaining the <em>private seed</em>.<a href="#section-1-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.2">
          <p id="section-1-5.2.1"><strong>Public key generation</strong>:
The subordinate party uses the public seed to autonomously generate a new public key
along with a unique <em>key handle</em> for the public key.
This can be repeated any number of times.<a href="#section-1-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.3">
          <p id="section-1-5.3.1"><strong>Private key derivation</strong>:
The delegating party uses a key handle and the private seed
to derive the private key corresponding to the public key generated along with the key handle.
This can be repeated with any number of key handles.<a href="#section-1-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-6">Notably, ARKG can be built entirely using established cryptographic primitives.
The required primitives are a public key blinding scheme, a key encapsulation mechanism (KEM),
a key derivation function (KDF) and a message authentication code (MAC) scheme.
Both conventional primitives and quantum-resistant alternatives exist that meet these requirements. <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span><a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="requirements-language">
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notation">
<section id="section-1.2">
        <h3 id="name-notation">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-notation" class="section-name selfRef">Notation</a>
        </h3>
<p id="section-1.2-1">The following notation is used throughout this document:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">
            <p id="section-1.2-2.1.1">The symbol <code>||</code> represents octet string concatenation.<a href="#section-1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.2">
            <p id="section-1.2-2.2.1">When literal text strings are to be interpreted as octet strings,
they are encoded using UTF-8.<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.3">
            <p id="section-1.2-2.3.1">Elliptic curve operations are written in additive notation:
<code>+</code> denotes point addition, i.e., the curve group operation;
<code>*</code> denotes point multiplication, i.e., repeated point addition;
and <code>+</code> also denotes scalar addition modulo the curve order.
<code>*</code> has higher precedence than <code>+</code>, i.e., <code>a + b * C</code> is equivalent to <code>a + (b * C)</code>.<a href="#section-1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.4">
            <p id="section-1.2-2.4.1"><code>Random(min_inc, max_exc)</code> represents a cryptographically secure random integer
greater than or equal to <code>min_inc</code> and strictly less than <code>max_exc</code>.<a href="#section-1.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="the-asynchronous-remote-key-generation-arkg-algorithm">
<section id="section-2">
      <h2 id="name-the-asynchronous-remote-key">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-the-asynchronous-remote-key" class="section-name selfRef">The Asynchronous Remote Key Generation (ARKG) algorithm</a>
      </h2>
<p id="section-2-1">The ARKG algorithm consists of three functions, each performed by one of two participants:
the <em>delegating party</em> or the <em>subordinate party</em>.
The delegating party generates an ARKG <em>seed pair</em> and emits the <em>public seed</em> to the subordinate party
while keeping the <em>private seed</em> secret.
The subordinate party can then use the public seed to generate derived public keys and <em>key handles</em>,
and the delegating party can use the private seed and a key handle to derive the corresponding private key.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The following subsections define the abstract instance parameters used to construct the three ARKG functions,
followed by the definitions of the three ARKG functions.<a href="#section-2-2" class="pilcrow">¶</a></p>
<div id="instance-parameters">
<section id="section-2.1">
        <h3 id="name-instance-parameters">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-instance-parameters" class="section-name selfRef">Instance parameters</a>
        </h3>
<p id="section-2.1-1">ARKG is composed of a suite of other algorithms.
The parameters of an ARKG instance are:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">
            <p id="section-2.1-2.1.1"><code>BL</code>: An asymmetric key blinding scheme <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span>, consisting of:<a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1.2.1">
                <p id="section-2.1-2.1.2.1.1">Function <code>BL-Generate-Keypair() -&gt; (pk, sk)</code>: Generate a blinding key pair.<a href="#section-2.1-2.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.2.1.2">
No input.<a href="#section-2.1-2.1.2.1.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.2.1.3">
Output consists of a blinding public key <code>pk</code> and a blinding secret key <code>sk</code>.<a href="#section-2.1-2.1.2.1.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.1.2.2">
                <p id="section-2.1-2.1.2.2.1">Function <code>BL-Blind-Public-Key(pk, tau) -&gt; pk_tau</code>: Deterministically compute a blinded public key.<a href="#section-2.1-2.1.2.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.2.2.2">
Input consists of a blinding public key <code>pk</code> and a blinding factor <code>tau</code>.<a href="#section-2.1-2.1.2.2.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.2.2.3">
Output consists of the blinded public key <code>pk_tau</code>.<a href="#section-2.1-2.1.2.2.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.1.2.3">
                <p id="section-2.1-2.1.2.3.1">Function <code>BL-Blind-Secret-Key(sk, tau) -&gt; sk_tau</code>: Deterministically compute a blinded secret key.<a href="#section-2.1-2.1.2.3.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.2.3.2">
Input consists of a blinding secret key <code>sk</code> and a blinding factor <code>tau</code>.<a href="#section-2.1-2.1.2.3.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.2.3.3">
Output consists of the blinded secret key <code>sk_tau</code>.<a href="#section-2.1-2.1.2.3.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.1.2.4">
                <p id="section-2.1-2.1.2.4.1">Integer <code>L_bl</code>: The length of the blinding factor <code>tau</code> in octets.<a href="#section-2.1-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.1-2.1.3">
<code>pk</code> and <code>pk_tau</code> are opaque octet strings of arbitrary length.
<code>tau</code> is an opaque octet string of length <code>L_bl</code>.
The representations of <code>sk</code>, <code>sk_tau</code> and <code>L_bl</code> are an undefined implementation detail.<a href="#section-2.1-2.1.3" class="pilcrow">¶</a></p>
<p id="section-2.1-2.1.4">
See <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span> for definitions of security properties required of the key blinding scheme <code>BL</code>.<a href="#section-2.1-2.1.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1"><code>KEM</code>: A key encapsulation mechanism, consisting of the functions:<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.2.2.1">
                <p id="section-2.1-2.2.2.1.1"><code>KEM-Generate-Keypair() -&gt; (pk, sk)</code>: Generate a key encapsulation key pair.<a href="#section-2.1-2.2.2.1.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2.1.2">
No input.<a href="#section-2.1-2.2.2.1.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2.1.3">
Output consists of public key <code>pk</code> and secret key <code>sk</code>.<a href="#section-2.1-2.2.2.1.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.2.2.2">
                <p id="section-2.1-2.2.2.2.1"><code>KEM-Encaps(pk) -&gt; (k, c)</code>: Generate a key encapsulation.<a href="#section-2.1-2.2.2.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2.2.2">
Input consists of an encapsulation public key <code>pk</code>.<a href="#section-2.1-2.2.2.2.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2.2.3">
Output consists of a shared secret <code>k</code> and an encapsulation ciphertext <code>c</code>.<a href="#section-2.1-2.2.2.2.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.2.2.3">
                <p id="section-2.1-2.2.2.3.1"><code>KEM-Decaps(sk, c) -&gt; k</code>: Decapsulate a shared secret.<a href="#section-2.1-2.2.2.3.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2.3.2">
Input consists of encapsulation secret key <code>sk</code> and encapsulation ciphertext <code>c</code>.<a href="#section-2.1-2.2.2.3.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2.3.3">
Output consists of the shared secret <code>k</code> on success, or an error otherwise.<a href="#section-2.1-2.2.2.3.3" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.1-2.2.3">
<code>pk</code>, <code>k</code> and <code>c</code> are opaque octet strings.
The representation of <code>sk</code> is an undefined implementation detail.<a href="#section-2.1-2.2.3" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.4">
See <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span> for definitions of security properties required of the key encapsulation mechanism <code>KEM</code>.<a href="#section-2.1-2.2.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.3">
            <p id="section-2.1-2.3.1"><code>MAC</code>: A message authentication code (MAC) scheme, consisting of:<a href="#section-2.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.3.2.1">
                <p id="section-2.1-2.3.2.1.1">Function <code>MAC-Tag(k, m) -&gt; t</code>: Generate a message authentication tag for a given message using a given key.<a href="#section-2.1-2.3.2.1.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.3.2.1.2">
Input consists of the shared MAC key <code>k</code> and the message <code>m</code>.<a href="#section-2.1-2.3.2.1.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.3.2.1.3">
Output consists of the MAC tag <code>t</code>.<a href="#section-2.1-2.3.2.1.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.3.2.2">
                <p id="section-2.1-2.3.2.2.1">Function <code>MAC-Verify(k, m, t) -&gt; { 0, 1 }</code>: Verify a message authentication tag.<a href="#section-2.1-2.3.2.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.3.2.2.2">
Input consists of the shared MAC key <code>k</code>, the message <code>m</code> and the MAC tag <code>t</code>.<a href="#section-2.1-2.3.2.2.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.3.2.2.3">
Output is 1 if and only if <code>MAC-Tag(k, m) = t</code>.<a href="#section-2.1-2.3.2.2.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-2.3.2.3">
                <p id="section-2.1-2.3.2.3.1">Integer <code>L_mac</code>: The length of the MAC key <code>k</code> in octets.<a href="#section-2.1-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.1-2.3.3">
<code>k</code> is an opaque octet string of length <code>L_mac</code>.
<code>m</code> and <code>t</code> are opaque octet strings of arbitrary length.
The representation of <code>L_mac</code> is an undefined implementation detail.<a href="#section-2.1-2.3.3" class="pilcrow">¶</a></p>
<p id="section-2.1-2.3.4">
See <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span> for definitions of security properties required of the message authentication code scheme <code>MAC</code>.<a href="#section-2.1-2.3.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.4">
            <p id="section-2.1-2.4.1"><code>KDF</code>: A variable-length key derivation function with the signature:
<code>KDF(info, ikm, L) -&gt; okm</code><a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.4.2">
Input consists of a domain separation parameter <code>info</code>, input key material <code>ikm</code> and output length <code>L</code>.<a href="#section-2.1-2.4.2" class="pilcrow">¶</a></p>
<p id="section-2.1-2.4.3">
Output consists of output key material <code>okm</code> of length <code>L</code> in octets.<a href="#section-2.1-2.4.3" class="pilcrow">¶</a></p>
<p id="section-2.1-2.4.4"><code>info</code> and <code>ikm</code> are opaque octet strings of arbitrary length.
<code>okm</code> is an opaque octet string of length <code>L</code>.
<code>L</code> is an integer with undefined representation.<a href="#section-2.1-2.4.4" class="pilcrow">¶</a></p>
<p id="section-2.1-2.4.5">
See <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span> for definitions of security properties required of the key derivation function <code>KDF</code>.<a href="#section-2.1-2.4.5" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-3">A concrete ARKG instantiation <span class="bcp14">MUST</span> specify the instantiation
of each of the above functions and values.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">The output keys of the <code>BL</code> scheme are also the output keys of the ARKG instance as a whole.
For example, if <code>BL-Blind-Public-Key</code> and <code>BL-Blind-Secret-Key</code> output ECDSA keys,
then the ARKG instance will also output ECDSA keys.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">Instantiations <span class="bcp14">MUST</span> satisfy the following compatibility criteria:<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-6.1">
            <p id="section-2.1-6.1.1">The output shared secret <code>k</code> of <code>KEM-Encaps</code> and <code>KEM-Decaps</code>
is a valid input key material <code>ikm</code> of <code>KDF</code>.<a href="#section-2.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-6.2">
            <p id="section-2.1-6.2.1">Output key material <code>okm</code> of length <code>L_bl</code> of <code>KDF</code>
is a valid input blinding factor <code>tau</code> of <code>BL-Blind-Public-Key</code> and <code>BL-Blind-Secret-Key</code>.<a href="#section-2.1-6.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-6.2.2">
It is permissible for some <code>KDF</code> outputs to not be valid blinding factors,
as long as this happens with negligible probability -
see <a href="#design-rationale-mac" class="auto internal xref">Section 9.1</a>.<a href="#section-2.1-6.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-6.3">
            <p id="section-2.1-6.3.1">Output key material <code>okm</code> of length <code>L_mac</code> of <code>KDF</code>
is a valid input MAC key <code>k</code> of <code>MAC-Tag(k, m)</code> and <code>MAC-Verify(k, m, t)</code>.<a href="#section-2.1-6.3.1" class="pilcrow">¶</a></p>
<p id="section-2.1-6.3.2">
It is permissible for some <code>KDF</code> outputs to not be valid MAC keys,
as long as this happens with negligible probability -
see <a href="#design-rationale-mac" class="auto internal xref">Section 9.1</a>.<a href="#section-2.1-6.3.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-7">We denote a concrete ARKG instance by the pattern <code>ARKG-BL-KEM-MAC-KDF</code>,
substituting the chosen instantiation for the <code>BL</code>, <code>KEM</code>, <code>MAC</code> and <code>KDF</code> parts.
Note that this pattern cannot in general be unambiguously parsed;
implementations <span class="bcp14">MUST NOT</span> attempt to construct an ARKG instance by parsing such a pattern string.
Concrete ARKG instances <span class="bcp14">MUST</span> always be identified by lookup in a registry of fully specified ARKG instances.
This is to prevent usage of algorithm combinations that may be incompatible or insecure.<a href="#section-2.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-function-arkg-generate-seed">
<section id="section-2.2">
        <h3 id="name-the-function-arkg-generate-">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-the-function-arkg-generate-" class="section-name selfRef">The function ARKG-Generate-Seed</a>
        </h3>
<p id="section-2.2-1">This function is performed by the delegating party.
The delegating party generates the ARKG seed pair <code>(pk, sk)</code>
and keeps the private seed <code>sk</code> secret, while the public seed <code>pk</code> is provided to the subordinate party.
The subordinate party will then be able to generate public keys on behalf of the delegating party.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-2.2-2">
<pre>
ARKG-Generate-Seed() -&gt; (pk, sk)
    ARKG instance parameters:
        BL        A key blinding scheme.
        KEM       A key encapsulation mechanism.

    Inputs: None

    Output:
        (pk, sk)  An ARKG seed pair with public seed pk
                    and private seed sk.

    The output (pk, sk) is calculated as follows:

    (pk_kem, sk_kem) = KEM-Generate-Keypair()
    (pk_bl, sk_bl) = BL-Generate-Keypair()
    pk = (pk_kem, pk_bl)
    sk = (sk_kem, sk_bl)
</pre><a href="#section-2.2-2" class="pilcrow">¶</a>
</div>
<div id="deterministic-key-generation">
<section id="section-2.2.1">
          <h4 id="name-deterministic-key-generatio">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-deterministic-key-generatio" class="section-name selfRef">Deterministic key generation</a>
          </h4>
<p id="section-2.2.1-1">Although the above definition expresses the key generation as opaque,
likely sampling uniformly random key distributions,
implementations <span class="bcp14">MAY</span> choose to implement the functions <code>BL-Generate-Keypair()</code>,
<code>KEM-Generate-Keypair()</code> and <code>ARKG-Generate-Seed()</code>
as deterministic functions of some out-of-band input.
This can be thought of as defining a single-use ARKG instance where these function outputs are static.
This use case is beyond the scope of this document
since the implementation of <code>ARKG-Generate-Seed</code> is internal to the delegating party,
even if applications choose to distribute the delegating party across multiple processing entities.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2">For example, one entity may randomly sample <code>pk_bl</code>, derive <code>pk_kem</code> deterministically from <code>pk_bl</code>
and submit only <code>pk_bl</code> to a separate service that uses the same procedure to also derive the same <code>pk_kem</code>.
This document considers both of these entities as parts of the same logical delegating party.<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="the-function-arkg-derive-public-key">
<section id="section-2.3">
        <h3 id="name-the-function-arkg-derive-pu">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-the-function-arkg-derive-pu" class="section-name selfRef">The function ARKG-Derive-Public-Key</a>
        </h3>
<p id="section-2.3-1">This function is performed by the subordinate party, which holds the ARKG public seed <code>pk = (pk_kem, pk_bl)</code>.
The resulting public key <code>pk'</code> can be provided to external parties to use in asymmetric cryptography protocols,
and the resulting key handle <code>kh</code> can be used by the delegating party to derive the private key corresponding to <code>pk'</code>.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">This function may be invoked any number of times with the same public seed,
in order to generate any number of public keys.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-2.3-3">
<pre>
ARKG-Derive-Public-Key((pk_kem, pk_bl), info) -&gt; (pk', kh)
    ARKG instance parameters:
        BL        A key blinding scheme.
        KEM       A key encapsulation mechanism.
        MAC       A MAC scheme.
        KDF       A key derivation function.
        L_bl      The length in octets of the blinding factor tau
                    of the key blinding scheme BL.
        L_mac     The length in octets of the MAC key
                    of the MAC scheme MAC.

    Inputs:
        pk_kem    A key encapsulation public key.
        pk_bl     A key blinding public key.
        info      An octet string containing optional context
                    and application specific information
                    (can be a zero-length string).

    Output:
        pk'       A blinded public key.
        kh        A key handle for deriving the blinded
                    secret key sk' corresponding to pk'.

    The output (pk', kh) is calculated as follows:

    (k, c) = KEM-Encaps(pk_kem)
    tau = KDF("arkg-blind" || 0x00 || info, k, L_bl)
    mk  = KDF("arkg-mac"   || 0x00 || info, k, L_mac)
    tag = MAC-Tag(mk, c || info)

    pk' = BL-Blind-Public-Key(pk_bl, tau)
    kh = (c, tag)
</pre><a href="#section-2.3-3" class="pilcrow">¶</a>
</div>
<p id="section-2.3-4">If this procedure aborts due to an error,
for example because <code>KDF</code> returns an invalid <code>tau</code> or <code>mk</code>,
the procedure can safely be retried with the same arguments.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-function-arkg-derive-secret-key">
<section id="section-2.4">
        <h3 id="name-the-function-arkg-derive-se">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-the-function-arkg-derive-se" class="section-name selfRef">The function ARKG-Derive-Secret-Key</a>
        </h3>
<p id="section-2.4-1">This function is performed by the delegating party, which holds the ARKG private seed <code>(sk_kem, sk_bl)</code>.
The resulting secret key <code>sk'</code> can be used in asymmetric cryptography protocols
to prove possession of <code>sk'</code> to an external party that has the corresponding public key.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">This function may be invoked any number of times with the same private seed,
in order to derive the same or different secret keys any number of times.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-2.4-3">
<pre>
ARKG-Derive-Secret-Key((sk_kem, sk_bl), kh, info) -&gt; sk'
    ARKG instance parameters:
        BL        A key blinding scheme.
        KEM       A key encapsulation mechanism.
        MAC       A MAC scheme.
        KDF       A key derivation function.
        L_bl      The length in octets of the blinding factor tau
                    of the key blinding scheme BL.
        L_mac     The length in octets of the MAC key
                    of the MAC scheme MAC.

    Inputs:
        sk_kem    A key encapsulation secret key.
        sk_bl     A key blinding secret key.
        kh        A key handle output from ARKG-Derive-Public-Key.
        info      An octet string containing optional context
                    and application specific information
                    (can be a zero-length string).

    Output:
        sk'       A blinded secret key.

    The output sk' is calculated as follows:

    (c, tag) = kh
    k = KEM-Decaps(sk_kem, c)
    mk = KDF("arkg-mac" || 0x00 || info, k, L_mac)

    If MAC-Verify(mk, c || info, tag) = 0:
        Abort with an error.

    tau = KDF("arkg-blind" || 0x00 || info, k, L_bl)
    sk' = BL-Blind-Secret-Key(sk_bl, tau)
</pre><a href="#section-2.4-3" class="pilcrow">¶</a>
</div>
<p id="section-2.4-4">Errors in this procedure are typically unrecoverable.
For example, <code>KDF</code> might return an invalid <code>tau</code> or <code>mk</code>, or the <code>tag</code> may be invalid.
ARKG instantiations <span class="bcp14">SHOULD</span> be chosen in a way that such errors are impossible
if <code>kh</code> was generated by an honest and correct implementation of <code>ARKG-Derive-Public-Key</code>.
Incorrect or malicious implementations of <code>ARKG-Derive-Public-Key</code> do not degrade the security
of a correct and honest implementation of <code>ARKG-Derive-Secret-Key</code>.
See also <a href="#design-rationale-mac" class="auto internal xref">Section 9.1</a>.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="generic-arkg-instantiations">
<section id="section-3">
      <h2 id="name-generic-arkg-instantiations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-generic-arkg-instantiations" class="section-name selfRef">Generic ARKG instantiations</a>
      </h2>
<p id="section-3-1">This section defines generic formulae for instantiating the individual ARKG parameters,
which can be used to define concrete ARKG instantiations.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="blinding-ec">
<section id="section-3.1">
        <h3 id="name-using-elliptic-curve-arithm">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-using-elliptic-curve-arithm" class="section-name selfRef">Using elliptic curve arithmetic for key blinding</a>
        </h3>
<p id="section-3.1-1">Instantiations of ARKG whose output keys are elliptic curve keys
can use elliptic curve arithmetic as the key blinding scheme <code>BL</code> <span><a href="#Wilson" class="internal xref">Frymann2020</a> [<a href="#Wilson" class="cite xref">Wilson</a>]</span>.
This section defines a general formula for such instantiations of <code>BL</code>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Let <code>crv</code> be an elliptic curve.
Then the <code>BL</code> parameter of ARKG may be instantiated as follows:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1">
            <p id="section-3.1-3.1.1">Elliptic curve points are encoded to and from octet strings
using the procedures defined in sections 2.3.3 and 2.3.4 of <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>.<a href="#section-3.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.2">
            <p id="section-3.1-3.2.1">Elliptic curve scalar values are encoded to and from octet strings
using the procedures defined in sections 2.3.7 and 2.3.8 of <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>.<a href="#section-3.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.3">
            <p id="section-3.1-3.3.1"><code>G</code> is the generator of <code>crv</code>.<a href="#section-3.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.4">
            <p id="section-3.1-3.4.1"><code>N</code> is the order of <code>G</code>.<a href="#section-3.1-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="lang-pseudocode sourcecode" id="section-3.1-4">
<pre>
BL-Generate-Keypair() -&gt; (pk, sk)

    sk = Random(1, N)
    pk = sk * G


BL-Blind-Public-Key(pk, tau) -&gt; pk_tau

    If tau = 0 or tau &gt;= N, abort with an error.
    pk_tau = pk + tau * G


BL-Blind-Secret-Key(sk, tau) -&gt; sk_tau

    If tau = 0 or tau &gt;= N, abort with an error.
    sk_tau_tmp = sk + tau
    If sk_tau_tmp = 0, abort with an error.
    sk_tau = sk_tau_tmp
</pre><a href="#section-3.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="kem-ecdh">
<section id="section-3.2">
        <h3 id="name-using-ecdh-as-the-kem">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-using-ecdh-as-the-kem" class="section-name selfRef">Using ECDH as the KEM</a>
        </h3>
<p id="section-3.2-1">Instantiations of ARKG can use ECDH <span>[<a href="#RFC6090" class="cite xref">RFC6090</a>]</span> as the key encapsulation mechanism <code>KEM</code> <span><a href="#Wilson" class="internal xref">Frymann2020</a> [<a href="#Wilson" class="cite xref">Wilson</a>]</span>.
This section defines a general formula for such instantiations of <code>KEM</code>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Let <code>crv</code> be an elliptic curve used for ECDH.
Then the <code>KEM</code> parameter of ARKG may be instantiated as follows:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.1">
            <p id="section-3.2-3.1.1">Elliptic curve points are encoded to and from octet strings
using the procedures defined in sections 2.3.3 and 2.3.4 of <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>.<a href="#section-3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.2">
            <p id="section-3.2-3.2.1">Elliptic curve coordinate field elements are encoded to and from octet strings
using the procedures defined in sections 2.3.5 and 2.3.6 of <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>.<a href="#section-3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.3">
            <p id="section-3.2-3.3.1">Elliptic curve scalar values are encoded to and from octet strings
using the procedures defined in sections 2.3.7 and 2.3.8 of <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>.<a href="#section-3.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.4">
            <p id="section-3.2-3.4.1"><code>ECDH(pk, sk)</code> represents the compact output of ECDH <span>[<a href="#RFC6090" class="cite xref">RFC6090</a>]</span>
using public key (curve point) <code>pk</code> and secret key (exponent) <code>sk</code>.<a href="#section-3.2-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.5">
            <p id="section-3.2-3.5.1"><code>G</code> is the generator of <code>crv</code>.<a href="#section-3.2-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.6">
            <p id="section-3.2-3.6.1"><code>N</code> is the order of <code>G</code>.<a href="#section-3.2-3.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="lang-pseudocode sourcecode" id="section-3.2-4">
<pre>
KEM-Generate-Keypair() -&gt; (pk, sk)

    sk = Random(1, N)
    pk = sk * G


KEM-Encaps(pk) -&gt; (k, c)
    (pk', sk') = KEM-Generate-Keypair()

    k = ECDH(pk, sk')
    c = pk'


KEM-Decaps(sk, c) -&gt; k

    pk' = c
    k = ECDH(pk', sk)
</pre><a href="#section-3.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="blinding-kem-same-key">
<section id="section-3.3">
        <h3 id="name-using-the-same-key-for-both">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-using-the-same-key-for-both" class="section-name selfRef">Using the same key for both key blinding and KEM</a>
        </h3>
<p id="section-3.3-1">When an ARKG instance uses the same type of key for both the key blinding and the KEM -
for example, if elliptic curve arithmetic is used for key blinding as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a>
and ECDH is used as the KEM as described in <a href="#kem-ecdh" class="auto internal xref">Section 3.2</a> <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span> -
then the two keys <span class="bcp14">MAY</span> be the same key.
Representations of such an ARKG seed <span class="bcp14">MAY</span> allow for omitting the second copy of the constituent key,
but such representations <span class="bcp14">MUST</span> clearly identify that the single constituent key is to be used
both as the key blinding key and the KEM key.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mac-hmac">
<section id="section-3.4">
        <h3 id="name-using-hmac-as-the-mac">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-using-hmac-as-the-mac" class="section-name selfRef">Using HMAC as the MAC</a>
        </h3>
<p id="section-3.4-1">Let <code>Hash</code> be a cryptographic hash function.
Then the <code>MAC</code> parameter of ARKG may be instantiated using HMAC <span>[<a href="#RFC2104" class="cite xref">RFC2104</a>]</span> as follows:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-3.4-2">
<pre>
MAC-Tag(k, m) -&gt; t

    t = HMAC-Hash(K=k, text=m)


MAC-Verify(k, m, t) -&gt; { 0, 1 }

    t' = HMAC-Hash(K=k, text=m)
    If t = t':
        return 1
    Else:
        return 0
</pre><a href="#section-3.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="kdf-hkdf">
<section id="section-3.5">
        <h3 id="name-using-hkdf-as-the-kdf">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-using-hkdf-as-the-kdf" class="section-name selfRef">Using HKDF as the KDF</a>
        </h3>
<p id="section-3.5-1">Let <code>Hash</code> be a cryptographic hash function.
Then the <code>KDF</code> parameter of ARKG may be instantiated using HKDF <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span> as follows:<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-3.5-2">
<pre>
KDF(info, ikm, L) -&gt; okm

    prk = HKDF-Extract with the arguments:
        Hash: Hash
        salt: not set
        IKM: ikm

    okm = HKDF-Expand with the arguments:
        Hash: Hash
        PRK: prk
        info: info
        L: L
</pre><a href="#section-3.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="concrete-arkg-instantiations">
<section id="section-4">
      <h2 id="name-concrete-arkg-instantiation">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-concrete-arkg-instantiation" class="section-name selfRef">Concrete ARKG instantiations</a>
      </h2>
<p id="section-4-1">This section defines an initial set of concrete ARKG instantiations.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">TODO: IANA registry? COSE/JOSE?<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="arkg-p256-ecdh-p256-hmac-sha256-hkdf-sha256">
<section id="section-4.1">
        <h3 id="name-arkg-p256-ecdh-p256-hmac-sh">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-arkg-p256-ecdh-p256-hmac-sh" class="section-name selfRef">ARKG-P256-ECDH-P256-HMAC-SHA256-HKDF-SHA256</a>
        </h3>
<p id="section-4.1-1">The identifier <code>ARKG-P256-ECDH-P256-HMAC-SHA256-HKDF-SHA256</code> represents the following ARKG instance:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1"><code>BL</code>: Elliptic curve arithmetic as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameter:<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1.2.1">
                <p id="section-4.1-2.1.2.1.1"><code>crv</code>: The NIST curve <code>secp256r1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1"><code>KEM</code>: ECDH as described in <a href="#kem-ecdh" class="auto internal xref">Section 3.2</a> with the parameter:<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.2.2.1">
                <p id="section-4.1-2.2.2.1.1"><code>crv</code>: The NIST curve <code>secp256r1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.1-2.3">
            <p id="section-4.1-2.3.1"><code>MAC</code>: HMAC as described in <a href="#mac-hmac" class="auto internal xref">Section 3.4</a> with the parameter:<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.3.2.1">
                <p id="section-4.1-2.3.2.1.1"><code>Hash</code>: SHA-256 [FIPS 180-4].<a href="#section-4.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.1-2.4">
            <p id="section-4.1-2.4.1"><code>KDF</code>: HKDF as described in <a href="#kdf-hkdf" class="auto internal xref">Section 3.5</a> with the parameter:<a href="#section-4.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.4.2.1">
                <p id="section-4.1-2.4.2.1.1"><code>Hash</code>: SHA-256 [FIPS 180-4].<a href="#section-4.1-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.1-2.5">
            <p id="section-4.1-2.5.1"><code>L_bl</code>: 32<a href="#section-4.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.6">
            <p id="section-4.1-2.6.1"><code>L_mac</code>: 32<a href="#section-4.1-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="arkg-p384-ecdh-p384-hmac-sha384-hkdf-sha384">
<section id="section-4.2">
        <h3 id="name-arkg-p384-ecdh-p384-hmac-sh">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-arkg-p384-ecdh-p384-hmac-sh" class="section-name selfRef">ARKG-P384-ECDH-P384-HMAC-SHA384-HKDF-SHA384</a>
        </h3>
<p id="section-4.2-1">The identifier <code>ARKG-P384-ECDH-P384-HMAC-SHA384-HKDF-SHA384</code> represents the following ARKG instance:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">
            <p id="section-4.2-2.1.1"><code>BL</code>: Elliptic curve arithmetic as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameter:<a href="#section-4.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1.2.1">
                <p id="section-4.2-2.1.2.1.1"><code>crv</code>: The NIST curve <code>secp384r1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.2-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.2-2.2">
            <p id="section-4.2-2.2.1"><code>KEM</code>: ECDH as described in <a href="#kem-ecdh" class="auto internal xref">Section 3.2</a> with the parameter:<a href="#section-4.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.2.2.1">
                <p id="section-4.2-2.2.2.1.1"><code>crv</code>: The NIST curve <code>secp384r1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.2-2.3">
            <p id="section-4.2-2.3.1"><code>MAC</code>: HMAC as described in <a href="#mac-hmac" class="auto internal xref">Section 3.4</a> with the parameter:<a href="#section-4.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.3.2.1">
                <p id="section-4.2-2.3.2.1.1"><code>Hash</code>: SHA-384 [FIPS 180-4].<a href="#section-4.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.2-2.4">
            <p id="section-4.2-2.4.1"><code>KDF</code>: HKDF as described in <a href="#kdf-hkdf" class="auto internal xref">Section 3.5</a> with the parameter:<a href="#section-4.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.4.2.1">
                <p id="section-4.2-2.4.2.1.1"><code>Hash</code>: SHA-384 [FIPS 180-4].<a href="#section-4.2-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.2-2.5">
            <p id="section-4.2-2.5.1"><code>L_bl</code>: 48<a href="#section-4.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.6">
            <p id="section-4.2-2.6.1"><code>L_mac</code>: 48<a href="#section-4.2-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="arkg-p521-ecdh-p521-hmac-sha512-hkdf-sha512">
<section id="section-4.3">
        <h3 id="name-arkg-p521-ecdh-p521-hmac-sh">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-arkg-p521-ecdh-p521-hmac-sh" class="section-name selfRef">ARKG-P521-ECDH-P521-HMAC-SHA512-HKDF-SHA512</a>
        </h3>
<p id="section-4.3-1">The identifier <code>ARKG-P521-ECDH-P521-HMAC-SHA512-HKDF-SHA512</code> represents the following ARKG instance:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.1">
            <p id="section-4.3-2.1.1"><code>BL</code>: Elliptic curve arithmetic as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameter:<a href="#section-4.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.1.2.1">
                <p id="section-4.3-2.1.2.1.1"><code>crv</code>: The NIST curve <code>secp521r1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.3-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.3-2.2">
            <p id="section-4.3-2.2.1"><code>KEM</code>: ECDH as described in <a href="#kem-ecdh" class="auto internal xref">Section 3.2</a> with the parameter:<a href="#section-4.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.2.2.1">
                <p id="section-4.3-2.2.2.1.1"><code>crv</code>: The NIST curve <code>secp521r1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.3-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.3-2.3">
            <p id="section-4.3-2.3.1"><code>MAC</code>: HMAC as described in <a href="#mac-hmac" class="auto internal xref">Section 3.4</a> with the parameter:<a href="#section-4.3-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.3.2.1">
                <p id="section-4.3-2.3.2.1.1"><code>Hash</code>: SHA-512 [FIPS 180-4].<a href="#section-4.3-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.3-2.4">
            <p id="section-4.3-2.4.1"><code>KDF</code>: HKDF as described in <a href="#kdf-hkdf" class="auto internal xref">Section 3.5</a> with the parameter:<a href="#section-4.3-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.4.2.1">
                <p id="section-4.3-2.4.2.1.1"><code>Hash</code>: SHA-512 [FIPS 180-4].<a href="#section-4.3-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.3-2.5">
            <p id="section-4.3-2.5.1"><code>L_bl</code>: 64<a href="#section-4.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.6">
            <p id="section-4.3-2.6.1"><code>L_mac</code>: 64<a href="#section-4.3-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="arkg-p256k-ecdh-p256k-hmac-sha256-hkdf-sha256">
<section id="section-4.4">
        <h3 id="name-arkg-p256k-ecdh-p256k-hmac-">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-arkg-p256k-ecdh-p256k-hmac-" class="section-name selfRef">ARKG-P256k-ECDH-P256k-HMAC-SHA256-HKDF-SHA256</a>
        </h3>
<p id="section-4.4-1">The identifier <code>ARKG-P256k-ECDH-P256k-HMAC-SHA256-HKDF-SHA256</code> represents the following ARKG instance:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">
            <p id="section-4.4-2.1.1"><code>BL</code>: Elliptic curve arithmetic as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameter:<a href="#section-4.4-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1.2.1">
                <p id="section-4.4-2.1.2.1.1"><code>crv</code>: The SECG curve <code>secp256k1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.4-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.4-2.2">
            <p id="section-4.4-2.2.1"><code>KEM</code>: ECDH as described in <a href="#kem-ecdh" class="auto internal xref">Section 3.2</a> with the parameter:<a href="#section-4.4-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.2.2.1">
                <p id="section-4.4-2.2.2.1.1"><code>crv</code>: The SECG curve <code>secp256k1</code> <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-4.4-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.4-2.3">
            <p id="section-4.4-2.3.1"><code>MAC</code>: HMAC as described in <a href="#mac-hmac" class="auto internal xref">Section 3.4</a> with the parameter:<a href="#section-4.4-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.3.2.1">
                <p id="section-4.4-2.3.2.1.1"><code>Hash</code>: SHA-256 [FIPS 180-4].<a href="#section-4.4-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.4-2.4">
            <p id="section-4.4-2.4.1"><code>KDF</code>: HKDF as described in <a href="#kdf-hkdf" class="auto internal xref">Section 3.5</a> with the parameter:<a href="#section-4.4-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.4.2.1">
                <p id="section-4.4-2.4.2.1.1"><code>Hash</code>: SHA-256 [FIPS 180-4].<a href="#section-4.4-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.4-2.5">
            <p id="section-4.4-2.5.1"><code>L_bl</code>: 32<a href="#section-4.4-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.6">
            <p id="section-4.4-2.6.1"><code>L_mac</code>: 32<a href="#section-4.4-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="arkg-ed25519-x25519-hmac-sha256-hkdf-sha256">
<section id="section-4.5">
        <h3 id="name-arkg-ed25519-x25519-hmac-sh">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-arkg-ed25519-x25519-hmac-sh" class="section-name selfRef">ARKG-Ed25519-X25519-HMAC-SHA256-HKDF-SHA256</a>
        </h3>
<p id="section-4.5-1">The identifier <code>ARKG-Ed25519-X25519-HMAC-SHA256-HKDF-SHA256</code> represents the following ARKG instance:<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-2.1">
            <p id="section-4.5-2.1.1"><code>BL</code>: Elliptic curve arithmetic as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameter:<a href="#section-4.5-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-2.1.2.1">
                <p id="section-4.5-2.1.2.1.1"><code>crv</code>: The curve <code>Ed25519</code> [REF?].<a href="#section-4.5-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.5-2.2">
            <p id="section-4.5-2.2.1"><code>KEM</code>: ECDH as described in <a href="#kem-ecdh" class="auto internal xref">Section 3.2</a> with the parameter:<a href="#section-4.5-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-2.2.2.1">
                <p id="section-4.5-2.2.2.1.1"><code>crv</code>: The curve <code>X25519</code> [REF?].<a href="#section-4.5-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.5-2.3">
            <p id="section-4.5-2.3.1"><code>MAC</code>: HMAC as described in <a href="#mac-hmac" class="auto internal xref">Section 3.4</a> with the parameter:<a href="#section-4.5-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-2.3.2.1">
                <p id="section-4.5-2.3.2.1.1"><code>Hash</code>: SHA-256 [FIPS 180-4].<a href="#section-4.5-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.5-2.4">
            <p id="section-4.5-2.4.1"><code>KDF</code>: HKDF as described in <a href="#kdf-hkdf" class="auto internal xref">Section 3.5</a> with the parameter:<a href="#section-4.5-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-2.4.2.1">
                <p id="section-4.5-2.4.2.1.1"><code>Hash</code>: SHA-256 [FIPS 180-4].<a href="#section-4.5-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.5-2.5">
            <p id="section-4.5-2.5.1"><code>L_bl</code>: 32<a href="#section-4.5-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-2.6">
            <p id="section-4.5-2.6.1"><code>L_mac</code>: 32<a href="#section-4.5-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="arkg-x25519-x25519-hmac-sha256-hkdf-sha256">
<section id="section-4.6">
        <h3 id="name-arkg-x25519-x25519-hmac-sha">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-arkg-x25519-x25519-hmac-sha" class="section-name selfRef">ARKG-X25519-X25519-HMAC-SHA256-HKDF-SHA256</a>
        </h3>
<p id="section-4.6-1">The identifier <code>ARKG-X25519-X25519-HMAC-SHA256-HKDF-SHA256</code> represents the following ARKG instance:<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-2.1">
            <p id="section-4.6-2.1.1"><code>BL</code>: Elliptic curve arithmetic as described in <a href="#blinding-ec" class="auto internal xref">Section 3.1</a> with the parameter:<a href="#section-4.6-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-2.1.2.1">
                <p id="section-4.6-2.1.2.1.1"><code>crv</code>: The curve <code>X25519</code> [REF?].<a href="#section-4.6-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.6-2.2">
            <p id="section-4.6-2.2.1"><code>KEM</code>: ECDH <span>[<a href="#RFC6090" class="cite xref">RFC6090</a>]</span> as described in <a href="#kem-ecdh" class="auto internal xref">Section 3.2</a> with the parameter:<a href="#section-4.6-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-2.2.2.1">
                <p id="section-4.6-2.2.2.1.1"><code>crv</code>: The curve <code>X25519</code> [REF?].<a href="#section-4.6-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.6-2.3">
            <p id="section-4.6-2.3.1"><code>MAC</code>: HMAC as described in <a href="#mac-hmac" class="auto internal xref">Section 3.4</a> with the parameter:<a href="#section-4.6-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-2.3.2.1">
                <p id="section-4.6-2.3.2.1.1"><code>Hash</code>: SHA-256 [FIPS 180-4].<a href="#section-4.6-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.6-2.4">
            <p id="section-4.6-2.4.1"><code>KDF</code>: HKDF as described in <a href="#kdf-hkdf" class="auto internal xref">Section 3.5</a> with the parameter:<a href="#section-4.6-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-2.4.2.1">
                <p id="section-4.6-2.4.2.1.1"><code>Hash</code>: SHA-256 [FIPS 180-4].<a href="#section-4.6-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.6-2.5">
            <p id="section-4.6-2.5.1"><code>L_bl</code>: 32<a href="#section-4.6-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-2.6">
            <p id="section-4.6-2.6.1"><code>L_mac</code>: 32<a href="#section-4.6-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="cose-bindings">
<section id="section-5">
      <h2 id="name-cose-bindings">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-cose-bindings" class="section-name selfRef">COSE bindings</a>
      </h2>
<p id="section-5-1">TODO?: Define COSE representations for interoperability:
- ARKG public seed (for interoperability between different implementers of <code>ARKG-Generate-Seed</code> and <code>ARKG-Derive-Public-Key</code>)
- ARKG key handle (for interoperability between different implementers of <code>ARKG-Derive-Public-Key</code> and <code>ARKG-Derive-Secret-Key</code>)<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">TODO<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Privacy">
<section id="section-7">
      <h2 id="name-privacy-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-7-1">TODO<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">TODO<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="design-rationale">
<section id="section-9">
      <h2 id="name-design-rationale">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-design-rationale" class="section-name selfRef">Design rationale</a>
      </h2>
<div id="design-rationale-mac">
<section id="section-9.1">
        <h3 id="name-using-a-mac">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-using-a-mac" class="section-name selfRef">Using a MAC</a>
        </h3>
<p id="section-9.1-1">The ARKG construction by Wilson <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span> omits the MAC and instead encodes application context in the PRF labels,
arguing this leads to invalid keys/signatures in cases that would have a bad MAC.
We choose to keep the MAC from the construction by Frymann et al. <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span> for two purposes.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">The first is so that the delegating party can distinguish between key handles addressed to it
and those addressed to other delegating parties.
We anticipate use cases where a private key usage request may contain key handles for several delegating parties
eligible to fulfill the request,
and the delegate party to be used can be chosen opportunistically depending on which are available at the time.
Without the MAC, choosing the wrong key handle would cause the <code>ARKG-Derive-Secret-Key</code> procedure to silently derive the wrong key
instead of returning an explicit error, which would in turn lead to an invalid signature or similar final output.
This would make it difficult or impossible to diagnose the root cause of the issue and present actionable user feedback.
The MAC also allows ARKG key handles to be transmitted via heterogeneous data channels,
possibly including a mix of ARKG key handles and similar values used for other algorithms.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">The second purpose is so that the delegating party can be assured that no errors should happen
during the execution of <code>ARKG-Derive-Secret-Key</code>, such as out-of-range or invalid key values.
For example, key generation in <code>ARKG-Derive-Public-Key</code> might be done by randomly testing candidates [NIST.SP.800-56Ar3]
and retrying <code>ARKG-Derive-Public-Key</code> until a valid candidate is found.
A MAC enables <code>ARKG-Derive-Secret-Key</code> to assume that the first candidate from a given pseudo-random seed will be successful,
and otherwise return an explicit error rejecting the key handle as invalid.
<code>ARKG-Derive-Public-Key</code> is likely to run on powerful general-purpose hardware, such as a laptop, smartphone or server,
while <code>ARKG-Derive-Secret-Key</code> might run on more constrained hardware such as a cryptographic smart card,
which benefits greatly from such optimizations.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1-4">It is straightforward to see that adding the MAC to the construction by Wilson
does not weaken the security properties defined by Frymann et al. <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span>:
the construction by Frymann et al. can be reduced to the ARKG construction in this document
by instantiating <code>KEM</code> as group exponentiation
and instantiating <code>BL</code> as group multiplication to blind public keys and modular integer addition to blind secret keys.
The <code>MAC</code> and <code>KDF</code> parameters correspond trivially to the MAC and KDF parameters in <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span>,
where KDF<sub>1</sub>(<em>k</em>) = KDF(<em>k</em>, <em>l</em><sub>1</sub>) and KDF<sub>2</sub>(<em>k</em>) = KDF(<em>k</em>, <em>l</em><sub>2</sub>)
with fixed labels <em>l</em><sub>1</sub> and <em>l</em><sub>2</sub>.
Hence if one can break PK-unlinkability or SK-security of the ARKG construction in this document,
one can also break the same property of the construction by Frymann et al.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-status">
<section id="section-9.2">
        <h3 id="name-implementation-status">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
        </h3>
<p id="section-9.2-1">TODO<a href="#section-9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2104">https://www.rfc-editor.org/rfc/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[RFC4949]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4949">https://www.rfc-editor.org/rfc/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5869">https://www.rfc-editor.org/rfc/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6090">[RFC6090]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Igoe, K.</span>, and <span class="refAuthor">M. Salter</span>, <span class="refTitle">"Fundamental Elliptic Curve Cryptography Algorithms"</span>, <span class="seriesInfo">RFC 6090</span>, <span class="seriesInfo">DOI 10.17487/RFC6090</span>, <time datetime="2011-02" class="refDate">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6090">https://www.rfc-editor.org/rfc/rfc6090</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC1">[SEC1]</dt>
        <dd>
<span class="refAuthor">Certicom Research</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography"</span>, <time datetime="2009" class="refDate">2009</time>, <span>&lt;<a href="http://www.secg.org/sec1-v2.pdf">http://www.secg.org/sec1-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC2">[SEC2]</dt>
      <dd>
<span class="refAuthor">Certicom Research</span>, <span class="refTitle">"SEC 2: Recommended Elliptic Curve Domain Parameters"</span>, <time datetime="2010" class="refDate">2010</time>, <span>&lt;<a href="http://www.secg.org/sec2-v2.pdf">http://www.secg.org/sec2-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BIP32">[BIP32]</dt>
        <dd>
<span class="refAuthor">Wuille, P.</span>, <span class="refTitle">"BIP 32 Hierarchical Deterministic Wallets"</span>, <time datetime="2012" class="refDate">2012</time>, <span>&lt;<a href="https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki">https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Clermont">[Clermont]</dt>
        <dd>
<span class="refAuthor">Clermont, S. A.</span> and <span class="refAuthor">Technische Universität Darmstadt</span>, <span class="refTitle">"Post Quantum Asynchronous Remote Key Generation. Master's thesis"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://www.cryptoplexity.informatik.tu-darmstadt.de/media/crypt/teaching_1/theses_1/Sebastian_Clermont_Thesis.pdf">https://www.cryptoplexity.informatik.tu-darmstadt.de/media/crypt/teaching_1/theses_1/Sebastian_Clermont_Thesis.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Frymann2020">[Frymann2020]</dt>
        <dd>
<span class="refAuthor">Frymann, N.</span>, <span class="refAuthor">Gardham, D.</span>, <span class="refAuthor">Kiefer, F.</span>, <span class="refAuthor">Lundberg, E.</span>, <span class="refAuthor">Manulis, M.</span>, and <span class="refAuthor">D. Nilsson</span>, <span class="refTitle">"Asynchronous Remote Key Generation: An Analysis of Yubico's Proposal for W3C WebAuthn. CCS '20: Proceedings of the 2020 ACM SIGSAC Conference on Computer and Communications Security"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://eprint.iacr.org/2020/1004">https://eprint.iacr.org/2020/1004</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Frymann2023">[Frymann2023]</dt>
        <dd>
<span class="refAuthor">Frymann, N.</span>, <span class="refAuthor">Gardham, D.</span>, and <span class="refAuthor">M. Manulis</span>, <span class="refTitle">"Asynchronous Remote Key Generation for Post-Quantum Cryptosystems from Lattices. 2023 IEEE 8th European Symposium on Security and Privacy"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://eprint.iacr.org/2023/419">https://eprint.iacr.org/2023/419</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WebAuthn-Recovery">[WebAuthn-Recovery]</dt>
        <dd>
<span class="refAuthor">Lundberg, E.</span> and <span class="refAuthor">D. Nilsson</span>, <span class="refTitle">"WebAuthn recovery extension: Asynchronous delegated key generation without shared secrets. GitHub"</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://github.com/Yubico/webauthn-recovery-extension">https://github.com/Yubico/webauthn-recovery-extension</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Wilson">[Wilson]</dt>
      <dd>
<span class="refAuthor">Wilson, S. M.</span> and <span class="refAuthor">University of Waterloo,</span>, <span class="refTitle">"Post-Quantum Account Recovery for Passwordless Authentication. Master's thesis"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="http://hdl.handle.net/10012/19316">http://hdl.handle.net/10012/19316</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">ARKG was first proposed under this name by Frymann et al. <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span>,
who analyzed a proposed extension to W3C Web Authentication by Lundberg and Nilsson <span>[<a href="#WebAuthn-Recovery" class="cite xref">WebAuthn-Recovery</a>]</span>,
which was in turn inspired by a similar construction by Wuille <span>[<a href="#BIP32" class="cite xref">BIP32</a>]</span> used to create privacy-preserving Bitcoin addresses.
Frymann et al. <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span> generalized the constructions by Lundberg, Nilsson and Wuille
from elliptic curves to any discrete logarithm (DL) problem,
and also proved the security of arbitrary asymmetric protocols composed with ARKG.
Further generalizations to include quantum-resistant instantiations
were developed independently by Clermont <span>[<a href="#Clermont" class="cite xref">Clermont</a>]</span>, Frymann et al. <span>[<a href="#Frymann2023" class="cite xref">Frymann2023</a>]</span> and Wilson <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">This document adopts the construction proposed by Wilson <span>[<a href="#Wilson" class="cite xref">Wilson</a>]</span>,
modified by the inclusion of a MAC in the key handles as done in the original construction by Frymann et al. <span>[<a href="#Frymann2020" class="cite xref">Frymann2020</a>]</span>.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">The authors would like to thank all of these authors for their research and development work that led to the creation of this document.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="test-vectors">
<section id="appendix-B">
      <h2 id="name-test-vectors">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="appendix-B-1">TODO<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-C">
      <h2 id="name-document-history">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-C-1">-00
  Initial Version<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">-01
  Editorial Fixes to formatting and references.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="appendix-D">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dain Nilsson</span></div>
<div dir="auto" class="left"><span class="org">Yubico</span></div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Emil Lundberg (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Yubico</span></div>
<div dir="auto" class="left"><span class="street-address">Kungsgatan 44</span></div>
<div dir="auto" class="left"><span class="locality">Stockholm</span></div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:emil@emlun.se" class="email">emil@emlun.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Bradley</span></div>
<div dir="auto" class="left"><span class="org">Yubico</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ve7jtb@ve7jtb.com" class="email">ve7jtb@ve7jtb.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
